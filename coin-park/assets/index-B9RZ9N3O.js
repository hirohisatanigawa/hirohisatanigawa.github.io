(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function e(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(r){if(r.ep)return;r.ep=!0;const s=e(r);fetch(r.href,s)}})();/**!
 * Sortable 1.15.6
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */function uo(i,t){var e=Object.keys(i);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(i);t&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(i,r).enumerable})),e.push.apply(e,n)}return e}function Ue(i){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?arguments[t]:{};t%2?uo(Object(e),!0).forEach(function(n){pi(i,n,e[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(e)):uo(Object(e)).forEach(function(n){Object.defineProperty(i,n,Object.getOwnPropertyDescriptor(e,n))})}return i}function un(i){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?un=function(t){return typeof t}:un=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},un(i)}function pi(i,t,e){return t in i?Object.defineProperty(i,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):i[t]=e,i}function ze(){return ze=Object.assign||function(i){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(i[n]=e[n])}return i},ze.apply(this,arguments)}function hi(i,t){if(i==null)return{};var e={},n=Object.keys(i),r,s;for(s=0;s<n.length;s++)r=n[s],!(t.indexOf(r)>=0)&&(e[r]=i[r]);return e}function _i(i,t){if(i==null)return{};var e=hi(i,t),n,r;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(i);for(r=0;r<s.length;r++)n=s[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(i,n)&&(e[n]=i[n])}return e}var gi="1.15.6";function Ke(i){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(i)}var et=Ke(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),Zt=Ke(/Edge/i),mo=Ke(/firefox/i),Ht=Ke(/safari/i)&&!Ke(/chrome/i)&&!Ke(/android/i),zn=Ke(/iP(ad|od|hone)/i),No=Ke(/chrome/i)&&Ke(/android/i),Ro={capture:!1,passive:!1};function j(i,t,e){i.addEventListener(t,e,!et&&Ro)}function P(i,t,e){i.removeEventListener(t,e,!et&&Ro)}function vn(i,t){if(t){if(t[0]===">"&&(t=t.substring(1)),i)try{if(i.matches)return i.matches(t);if(i.msMatchesSelector)return i.msMatchesSelector(t);if(i.webkitMatchesSelector)return i.webkitMatchesSelector(t)}catch{return!1}return!1}}function Lo(i){return i.host&&i!==document&&i.host.nodeType?i.host:i.parentNode}function Le(i,t,e,n){if(i){e=e||document;do{if(t!=null&&(t[0]===">"?i.parentNode===e&&vn(i,t):vn(i,t))||n&&i===e)return i;if(i===e)break}while(i=Lo(i))}return null}var fo=/\s+/g;function Ae(i,t,e){if(i&&t)if(i.classList)i.classList[e?"add":"remove"](t);else{var n=(" "+i.className+" ").replace(fo," ").replace(" "+t+" "," ");i.className=(n+(e?" "+t:"")).replace(fo," ")}}function A(i,t,e){var n=i&&i.style;if(n){if(e===void 0)return document.defaultView&&document.defaultView.getComputedStyle?e=document.defaultView.getComputedStyle(i,""):i.currentStyle&&(e=i.currentStyle),t===void 0?e:e[t];!(t in n)&&t.indexOf("webkit")===-1&&(t="-webkit-"+t),n[t]=e+(typeof e=="string"?"":"px")}}function xt(i,t){var e="";if(typeof i=="string")e=i;else do{var n=A(i,"transform");n&&n!=="none"&&(e=n+" "+e)}while(!t&&(i=i.parentNode));var r=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return r&&new r(e)}function Bo(i,t,e){if(i){var n=i.getElementsByTagName(t),r=0,s=n.length;if(e)for(;r<s;r++)e(n[r],r);return n}return[]}function qe(){var i=document.scrollingElement;return i||document.documentElement}function J(i,t,e,n,r){if(!(!i.getBoundingClientRect&&i!==window)){var s,l,f,d,u,_,o;if(i!==window&&i.parentNode&&i!==qe()?(s=i.getBoundingClientRect(),l=s.top,f=s.left,d=s.bottom,u=s.right,_=s.height,o=s.width):(l=0,f=0,d=window.innerHeight,u=window.innerWidth,_=window.innerHeight,o=window.innerWidth),(t||e)&&i!==window&&(r=r||i.parentNode,!et))do if(r&&r.getBoundingClientRect&&(A(r,"transform")!=="none"||e&&A(r,"position")!=="static")){var a=r.getBoundingClientRect();l-=a.top+parseInt(A(r,"border-top-width")),f-=a.left+parseInt(A(r,"border-left-width")),d=l+s.height,u=f+s.width;break}while(r=r.parentNode);if(n&&i!==window){var c=xt(r||i),m=c&&c.a,p=c&&c.d;c&&(l/=p,f/=m,o/=m,_/=p,d=l+_,u=f+o)}return{top:l,left:f,bottom:d,right:u,width:o,height:_}}}function po(i,t,e){for(var n=st(i,!0),r=J(i)[t];n;){var s=J(n)[e],l=void 0;if(l=r>=s,!l)return n;if(n===qe())break;n=st(n,!1)}return!1}function It(i,t,e,n){for(var r=0,s=0,l=i.children;s<l.length;){if(l[s].style.display!=="none"&&l[s]!==w.ghost&&(n||l[s]!==w.dragged)&&Le(l[s],e.draggable,i,!1)){if(r===t)return l[s];r++}s++}return null}function eo(i,t){for(var e=i.lastElementChild;e&&(e===w.ghost||A(e,"display")==="none"||t&&!vn(e,t));)e=e.previousElementSibling;return e||null}function Pe(i,t){var e=0;if(!i||!i.parentNode)return-1;for(;i=i.previousElementSibling;)i.nodeName.toUpperCase()!=="TEMPLATE"&&i!==w.clone&&(!t||vn(i,t))&&e++;return e}function ho(i){var t=0,e=0,n=qe();if(i)do{var r=xt(i),s=r.a,l=r.d;t+=i.scrollLeft*s,e+=i.scrollTop*l}while(i!==n&&(i=i.parentNode));return[t,e]}function vi(i,t){for(var e in i)if(i.hasOwnProperty(e)){for(var n in t)if(t.hasOwnProperty(n)&&t[n]===i[e][n])return Number(e)}return-1}function st(i,t){if(!i||!i.getBoundingClientRect)return qe();var e=i,n=!1;do if(e.clientWidth<e.scrollWidth||e.clientHeight<e.scrollHeight){var r=A(e);if(e.clientWidth<e.scrollWidth&&(r.overflowX=="auto"||r.overflowX=="scroll")||e.clientHeight<e.scrollHeight&&(r.overflowY=="auto"||r.overflowY=="scroll")){if(!e.getBoundingClientRect||e===document.body)return qe();if(n||t)return e;n=!0}}while(e=e.parentNode);return qe()}function yi(i,t){if(i&&t)for(var e in t)t.hasOwnProperty(e)&&(i[e]=t[e]);return i}function jn(i,t){return Math.round(i.top)===Math.round(t.top)&&Math.round(i.left)===Math.round(t.left)&&Math.round(i.height)===Math.round(t.height)&&Math.round(i.width)===Math.round(t.width)}var Gt;function Fo(i,t){return function(){if(!Gt){var e=arguments,n=this;e.length===1?i.call(n,e[0]):i.apply(n,e),Gt=setTimeout(function(){Gt=void 0},t)}}}function Ti(){clearTimeout(Gt),Gt=void 0}function $o(i,t,e){i.scrollLeft+=t,i.scrollTop+=e}function Ho(i){var t=window.Polymer,e=window.jQuery||window.Zepto;return t&&t.dom?t.dom(i).cloneNode(!0):e?e(i).clone(!0)[0]:i.cloneNode(!0)}function Go(i,t,e){var n={};return Array.from(i.children).forEach(function(r){var s,l,f,d;if(!(!Le(r,t.draggable,i,!1)||r.animated||r===e)){var u=J(r);n.left=Math.min((s=n.left)!==null&&s!==void 0?s:1/0,u.left),n.top=Math.min((l=n.top)!==null&&l!==void 0?l:1/0,u.top),n.right=Math.max((f=n.right)!==null&&f!==void 0?f:-1/0,u.right),n.bottom=Math.max((d=n.bottom)!==null&&d!==void 0?d:-1/0,u.bottom)}}),n.width=n.right-n.left,n.height=n.bottom-n.top,n.x=n.left,n.y=n.top,n}var Te="Sortable"+new Date().getTime();function bi(){var i=[],t;return{captureAnimationState:function(){if(i=[],!!this.options.animation){var n=[].slice.call(this.el.children);n.forEach(function(r){if(!(A(r,"display")==="none"||r===w.ghost)){i.push({target:r,rect:J(r)});var s=Ue({},i[i.length-1].rect);if(r.thisAnimationDuration){var l=xt(r,!0);l&&(s.top-=l.f,s.left-=l.e)}r.fromRect=s}})}},addAnimationState:function(n){i.push(n)},removeAnimationState:function(n){i.splice(vi(i,{target:n}),1)},animateAll:function(n){var r=this;if(!this.options.animation){clearTimeout(t),typeof n=="function"&&n();return}var s=!1,l=0;i.forEach(function(f){var d=0,u=f.target,_=u.fromRect,o=J(u),a=u.prevFromRect,c=u.prevToRect,m=f.rect,p=xt(u,!0);p&&(o.top-=p.f,o.left-=p.e),u.toRect=o,u.thisAnimationDuration&&jn(a,o)&&!jn(_,o)&&(m.top-o.top)/(m.left-o.left)===(_.top-o.top)/(_.left-o.left)&&(d=Ai(m,a,c,r.options)),jn(o,_)||(u.prevFromRect=_,u.prevToRect=o,d||(d=r.options.animation),r.animate(u,m,o,d)),d&&(s=!0,l=Math.max(l,d),clearTimeout(u.animationResetTimer),u.animationResetTimer=setTimeout(function(){u.animationTime=0,u.prevFromRect=null,u.fromRect=null,u.prevToRect=null,u.thisAnimationDuration=null},d),u.thisAnimationDuration=d)}),clearTimeout(t),s?t=setTimeout(function(){typeof n=="function"&&n()},l):typeof n=="function"&&n(),i=[]},animate:function(n,r,s,l){if(l){A(n,"transition",""),A(n,"transform","");var f=xt(this.el),d=f&&f.a,u=f&&f.d,_=(r.left-s.left)/(d||1),o=(r.top-s.top)/(u||1);n.animatingX=!!_,n.animatingY=!!o,A(n,"transform","translate3d("+_+"px,"+o+"px,0)"),this.forRepaintDummy=wi(n),A(n,"transition","transform "+l+"ms"+(this.options.easing?" "+this.options.easing:"")),A(n,"transform","translate3d(0,0,0)"),typeof n.animated=="number"&&clearTimeout(n.animated),n.animated=setTimeout(function(){A(n,"transition",""),A(n,"transform",""),n.animated=!1,n.animatingX=!1,n.animatingY=!1},l)}}}}function wi(i){return i.offsetWidth}function Ai(i,t,e,n){return Math.sqrt(Math.pow(t.top-i.top,2)+Math.pow(t.left-i.left,2))/Math.sqrt(Math.pow(t.top-e.top,2)+Math.pow(t.left-e.left,2))*n.animation}var vt=[],On={initializeByDefault:!0},Jt={mount:function(t){for(var e in On)On.hasOwnProperty(e)&&!(e in t)&&(t[e]=On[e]);vt.forEach(function(n){if(n.pluginName===t.pluginName)throw"Sortable: Cannot mount plugin ".concat(t.pluginName," more than once")}),vt.push(t)},pluginEvent:function(t,e,n){var r=this;this.eventCanceled=!1,n.cancel=function(){r.eventCanceled=!0};var s=t+"Global";vt.forEach(function(l){e[l.pluginName]&&(e[l.pluginName][s]&&e[l.pluginName][s](Ue({sortable:e},n)),e.options[l.pluginName]&&e[l.pluginName][t]&&e[l.pluginName][t](Ue({sortable:e},n)))})},initializePlugins:function(t,e,n,r){vt.forEach(function(f){var d=f.pluginName;if(!(!t.options[d]&&!f.initializeByDefault)){var u=new f(t,e,t.options);u.sortable=t,u.options=t.options,t[d]=u,ze(n,u.defaults)}});for(var s in t.options)if(t.options.hasOwnProperty(s)){var l=this.modifyOption(t,s,t.options[s]);typeof l<"u"&&(t.options[s]=l)}},getEventProperties:function(t,e){var n={};return vt.forEach(function(r){typeof r.eventProperties=="function"&&ze(n,r.eventProperties.call(e[r.pluginName],t))}),n},modifyOption:function(t,e,n){var r;return vt.forEach(function(s){t[s.pluginName]&&s.optionListeners&&typeof s.optionListeners[e]=="function"&&(r=s.optionListeners[e].call(t[s.pluginName],n))}),r}};function Ei(i){var t=i.sortable,e=i.rootEl,n=i.name,r=i.targetEl,s=i.cloneEl,l=i.toEl,f=i.fromEl,d=i.oldIndex,u=i.newIndex,_=i.oldDraggableIndex,o=i.newDraggableIndex,a=i.originalEvent,c=i.putSortable,m=i.extraEventProperties;if(t=t||e&&e[Te],!!t){var p,g=t.options,h="on"+n.charAt(0).toUpperCase()+n.substr(1);window.CustomEvent&&!et&&!Zt?p=new CustomEvent(n,{bubbles:!0,cancelable:!0}):(p=document.createEvent("Event"),p.initEvent(n,!0,!0)),p.to=l||e,p.from=f||e,p.item=r||e,p.clone=s,p.oldIndex=d,p.newIndex=u,p.oldDraggableIndex=_,p.newDraggableIndex=o,p.originalEvent=a,p.pullMode=c?c.lastPutMode:void 0;var v=Ue(Ue({},m),Jt.getEventProperties(n,t));for(var T in v)p[T]=v[T];e&&e.dispatchEvent(p),g[h]&&g[h].call(t,p)}}var Si=["evt"],ye=function(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=n.evt,s=_i(n,Si);Jt.pluginEvent.bind(w)(t,e,Ue({dragEl:y,parentEl:G,ghostEl:x,rootEl:F,nextEl:ft,lastDownEl:dn,cloneEl:H,cloneHidden:rt,dragStarted:Lt,putSortable:oe,activeSortable:w.active,originalEvent:r,oldIndex:Et,oldDraggableIndex:Vt,newIndex:Ee,newDraggableIndex:it,hideGhostForTarget:Uo,unhideGhostForTarget:Yo,cloneNowHidden:function(){rt=!0},cloneNowShown:function(){rt=!1},dispatchSortableEvent:function(f){me({sortable:e,name:f,originalEvent:r})}},s))};function me(i){Ei(Ue({putSortable:oe,cloneEl:H,targetEl:y,rootEl:F,oldIndex:Et,oldDraggableIndex:Vt,newIndex:Ee,newDraggableIndex:it},i))}var y,G,x,F,ft,dn,H,rt,Et,Ee,Vt,it,tn,oe,bt=!1,yn=!1,Tn=[],ct,ke,Mn,kn,_o,go,Lt,yt,Xt,qt=!1,nn=!1,mn,le,Nn=[],Un=!1,bn=[],Sn=typeof document<"u",on=zn,vo=Zt||et?"cssFloat":"float",xi=Sn&&!No&&!zn&&"draggable"in document.createElement("div"),Vo=function(){if(Sn){if(et)return!1;var i=document.createElement("x");return i.style.cssText="pointer-events:auto",i.style.pointerEvents==="auto"}}(),Xo=function(t,e){var n=A(t),r=parseInt(n.width)-parseInt(n.paddingLeft)-parseInt(n.paddingRight)-parseInt(n.borderLeftWidth)-parseInt(n.borderRightWidth),s=It(t,0,e),l=It(t,1,e),f=s&&A(s),d=l&&A(l),u=f&&parseInt(f.marginLeft)+parseInt(f.marginRight)+J(s).width,_=d&&parseInt(d.marginLeft)+parseInt(d.marginRight)+J(l).width;if(n.display==="flex")return n.flexDirection==="column"||n.flexDirection==="column-reverse"?"vertical":"horizontal";if(n.display==="grid")return n.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(s&&f.float&&f.float!=="none"){var o=f.float==="left"?"left":"right";return l&&(d.clear==="both"||d.clear===o)?"vertical":"horizontal"}return s&&(f.display==="block"||f.display==="flex"||f.display==="table"||f.display==="grid"||u>=r&&n[vo]==="none"||l&&n[vo]==="none"&&u+_>r)?"vertical":"horizontal"},Ci=function(t,e,n){var r=n?t.left:t.top,s=n?t.right:t.bottom,l=n?t.width:t.height,f=n?e.left:e.top,d=n?e.right:e.bottom,u=n?e.width:e.height;return r===f||s===d||r+l/2===f+u/2},Di=function(t,e){var n;return Tn.some(function(r){var s=r[Te].options.emptyInsertThreshold;if(!(!s||eo(r))){var l=J(r),f=t>=l.left-s&&t<=l.right+s,d=e>=l.top-s&&e<=l.bottom+s;if(f&&d)return n=r}}),n},qo=function(t){function e(s,l){return function(f,d,u,_){var o=f.options.group.name&&d.options.group.name&&f.options.group.name===d.options.group.name;if(s==null&&(l||o))return!0;if(s==null||s===!1)return!1;if(l&&s==="clone")return s;if(typeof s=="function")return e(s(f,d,u,_),l)(f,d,u,_);var a=(l?f:d).options.group.name;return s===!0||typeof s=="string"&&s===a||s.join&&s.indexOf(a)>-1}}var n={},r=t.group;(!r||un(r)!="object")&&(r={name:r}),n.name=r.name,n.checkPull=e(r.pull,!0),n.checkPut=e(r.put),n.revertClone=r.revertClone,t.group=n},Uo=function(){!Vo&&x&&A(x,"display","none")},Yo=function(){!Vo&&x&&A(x,"display","")};Sn&&!No&&document.addEventListener("click",function(i){if(yn)return i.preventDefault(),i.stopPropagation&&i.stopPropagation(),i.stopImmediatePropagation&&i.stopImmediatePropagation(),yn=!1,!1},!0);var ut=function(t){if(y){t=t.touches?t.touches[0]:t;var e=Di(t.clientX,t.clientY);if(e){var n={};for(var r in t)t.hasOwnProperty(r)&&(n[r]=t[r]);n.target=n.rootEl=e,n.preventDefault=void 0,n.stopPropagation=void 0,e[Te]._onDragOver(n)}}},Ii=function(t){y&&y.parentNode[Te]._isOutsideThisEl(t.target)};function w(i,t){if(!(i&&i.nodeType&&i.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(i));this.el=i,this.options=t=ze({},t),i[Te]=this;var e={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(i.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return Xo(i,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(l,f){l.setData("Text",f.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:w.supportPointer!==!1&&"PointerEvent"in window&&(!Ht||zn),emptyInsertThreshold:5};Jt.initializePlugins(this,i,e);for(var n in e)!(n in t)&&(t[n]=e[n]);qo(t);for(var r in this)r.charAt(0)==="_"&&typeof this[r]=="function"&&(this[r]=this[r].bind(this));this.nativeDraggable=t.forceFallback?!1:xi,this.nativeDraggable&&(this.options.touchStartThreshold=1),t.supportPointer?j(i,"pointerdown",this._onTapStart):(j(i,"mousedown",this._onTapStart),j(i,"touchstart",this._onTapStart)),this.nativeDraggable&&(j(i,"dragover",this),j(i,"dragenter",this)),Tn.push(this.el),t.store&&t.store.get&&this.sort(t.store.get(this)||[]),ze(this,bi())}w.prototype={constructor:w,_isOutsideThisEl:function(t){!this.el.contains(t)&&t!==this.el&&(yt=null)},_getDirection:function(t,e){return typeof this.options.direction=="function"?this.options.direction.call(this,t,e,y):this.options.direction},_onTapStart:function(t){if(t.cancelable){var e=this,n=this.el,r=this.options,s=r.preventOnFilter,l=t.type,f=t.touches&&t.touches[0]||t.pointerType&&t.pointerType==="touch"&&t,d=(f||t).target,u=t.target.shadowRoot&&(t.path&&t.path[0]||t.composedPath&&t.composedPath()[0])||d,_=r.filter;if(Li(n),!y&&!(/mousedown|pointerdown/.test(l)&&t.button!==0||r.disabled)&&!u.isContentEditable&&!(!this.nativeDraggable&&Ht&&d&&d.tagName.toUpperCase()==="SELECT")&&(d=Le(d,r.draggable,n,!1),!(d&&d.animated)&&dn!==d)){if(Et=Pe(d),Vt=Pe(d,r.draggable),typeof _=="function"){if(_.call(this,t,d,this)){me({sortable:e,rootEl:u,name:"filter",targetEl:d,toEl:n,fromEl:n}),ye("filter",e,{evt:t}),s&&t.preventDefault();return}}else if(_&&(_=_.split(",").some(function(o){if(o=Le(u,o.trim(),n,!1),o)return me({sortable:e,rootEl:o,name:"filter",targetEl:d,fromEl:n,toEl:n}),ye("filter",e,{evt:t}),!0}),_)){s&&t.preventDefault();return}r.handle&&!Le(u,r.handle,n,!1)||this._prepareDragStart(t,f,d)}}},_prepareDragStart:function(t,e,n){var r=this,s=r.el,l=r.options,f=s.ownerDocument,d;if(n&&!y&&n.parentNode===s){var u=J(n);if(F=s,y=n,G=y.parentNode,ft=y.nextSibling,dn=n,tn=l.group,w.dragged=y,ct={target:y,clientX:(e||t).clientX,clientY:(e||t).clientY},_o=ct.clientX-u.left,go=ct.clientY-u.top,this._lastX=(e||t).clientX,this._lastY=(e||t).clientY,y.style["will-change"]="all",d=function(){if(ye("delayEnded",r,{evt:t}),w.eventCanceled){r._onDrop();return}r._disableDelayedDragEvents(),!mo&&r.nativeDraggable&&(y.draggable=!0),r._triggerDragStart(t,e),me({sortable:r,name:"choose",originalEvent:t}),Ae(y,l.chosenClass,!0)},l.ignore.split(",").forEach(function(_){Bo(y,_.trim(),Rn)}),j(f,"dragover",ut),j(f,"mousemove",ut),j(f,"touchmove",ut),l.supportPointer?(j(f,"pointerup",r._onDrop),!this.nativeDraggable&&j(f,"pointercancel",r._onDrop)):(j(f,"mouseup",r._onDrop),j(f,"touchend",r._onDrop),j(f,"touchcancel",r._onDrop)),mo&&this.nativeDraggable&&(this.options.touchStartThreshold=4,y.draggable=!0),ye("delayStart",this,{evt:t}),l.delay&&(!l.delayOnTouchOnly||e)&&(!this.nativeDraggable||!(Zt||et))){if(w.eventCanceled){this._onDrop();return}l.supportPointer?(j(f,"pointerup",r._disableDelayedDrag),j(f,"pointercancel",r._disableDelayedDrag)):(j(f,"mouseup",r._disableDelayedDrag),j(f,"touchend",r._disableDelayedDrag),j(f,"touchcancel",r._disableDelayedDrag)),j(f,"mousemove",r._delayedDragTouchMoveHandler),j(f,"touchmove",r._delayedDragTouchMoveHandler),l.supportPointer&&j(f,"pointermove",r._delayedDragTouchMoveHandler),r._dragStartTimer=setTimeout(d,l.delay)}else d()}},_delayedDragTouchMoveHandler:function(t){var e=t.touches?t.touches[0]:t;Math.max(Math.abs(e.clientX-this._lastX),Math.abs(e.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){y&&Rn(y),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var t=this.el.ownerDocument;P(t,"mouseup",this._disableDelayedDrag),P(t,"touchend",this._disableDelayedDrag),P(t,"touchcancel",this._disableDelayedDrag),P(t,"pointerup",this._disableDelayedDrag),P(t,"pointercancel",this._disableDelayedDrag),P(t,"mousemove",this._delayedDragTouchMoveHandler),P(t,"touchmove",this._delayedDragTouchMoveHandler),P(t,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(t,e){e=e||t.pointerType=="touch"&&t,!this.nativeDraggable||e?this.options.supportPointer?j(document,"pointermove",this._onTouchMove):e?j(document,"touchmove",this._onTouchMove):j(document,"mousemove",this._onTouchMove):(j(y,"dragend",this),j(F,"dragstart",this._onDragStart));try{document.selection?fn(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(t,e){if(bt=!1,F&&y){ye("dragStarted",this,{evt:e}),this.nativeDraggable&&j(document,"dragover",Ii);var n=this.options;!t&&Ae(y,n.dragClass,!1),Ae(y,n.ghostClass,!0),w.active=this,t&&this._appendGhost(),me({sortable:this,name:"start",originalEvent:e})}else this._nulling()},_emulateDragOver:function(){if(ke){this._lastX=ke.clientX,this._lastY=ke.clientY,Uo();for(var t=document.elementFromPoint(ke.clientX,ke.clientY),e=t;t&&t.shadowRoot&&(t=t.shadowRoot.elementFromPoint(ke.clientX,ke.clientY),t!==e);)e=t;if(y.parentNode[Te]._isOutsideThisEl(t),e)do{if(e[Te]){var n=void 0;if(n=e[Te]._onDragOver({clientX:ke.clientX,clientY:ke.clientY,target:t,rootEl:e}),n&&!this.options.dragoverBubble)break}t=e}while(e=Lo(e));Yo()}},_onTouchMove:function(t){if(ct){var e=this.options,n=e.fallbackTolerance,r=e.fallbackOffset,s=t.touches?t.touches[0]:t,l=x&&xt(x,!0),f=x&&l&&l.a,d=x&&l&&l.d,u=on&&le&&ho(le),_=(s.clientX-ct.clientX+r.x)/(f||1)+(u?u[0]-Nn[0]:0)/(f||1),o=(s.clientY-ct.clientY+r.y)/(d||1)+(u?u[1]-Nn[1]:0)/(d||1);if(!w.active&&!bt){if(n&&Math.max(Math.abs(s.clientX-this._lastX),Math.abs(s.clientY-this._lastY))<n)return;this._onDragStart(t,!0)}if(x){l?(l.e+=_-(Mn||0),l.f+=o-(kn||0)):l={a:1,b:0,c:0,d:1,e:_,f:o};var a="matrix(".concat(l.a,",").concat(l.b,",").concat(l.c,",").concat(l.d,",").concat(l.e,",").concat(l.f,")");A(x,"webkitTransform",a),A(x,"mozTransform",a),A(x,"msTransform",a),A(x,"transform",a),Mn=_,kn=o,ke=s}t.cancelable&&t.preventDefault()}},_appendGhost:function(){if(!x){var t=this.options.fallbackOnBody?document.body:F,e=J(y,!0,on,!0,t),n=this.options;if(on){for(le=t;A(le,"position")==="static"&&A(le,"transform")==="none"&&le!==document;)le=le.parentNode;le!==document.body&&le!==document.documentElement?(le===document&&(le=qe()),e.top+=le.scrollTop,e.left+=le.scrollLeft):le=qe(),Nn=ho(le)}x=y.cloneNode(!0),Ae(x,n.ghostClass,!1),Ae(x,n.fallbackClass,!0),Ae(x,n.dragClass,!0),A(x,"transition",""),A(x,"transform",""),A(x,"box-sizing","border-box"),A(x,"margin",0),A(x,"top",e.top),A(x,"left",e.left),A(x,"width",e.width),A(x,"height",e.height),A(x,"opacity","0.8"),A(x,"position",on?"absolute":"fixed"),A(x,"zIndex","100000"),A(x,"pointerEvents","none"),w.ghost=x,t.appendChild(x),A(x,"transform-origin",_o/parseInt(x.style.width)*100+"% "+go/parseInt(x.style.height)*100+"%")}},_onDragStart:function(t,e){var n=this,r=t.dataTransfer,s=n.options;if(ye("dragStart",this,{evt:t}),w.eventCanceled){this._onDrop();return}ye("setupClone",this),w.eventCanceled||(H=Ho(y),H.removeAttribute("id"),H.draggable=!1,H.style["will-change"]="",this._hideClone(),Ae(H,this.options.chosenClass,!1),w.clone=H),n.cloneId=fn(function(){ye("clone",n),!w.eventCanceled&&(n.options.removeCloneOnHide||F.insertBefore(H,y),n._hideClone(),me({sortable:n,name:"clone"}))}),!e&&Ae(y,s.dragClass,!0),e?(yn=!0,n._loopId=setInterval(n._emulateDragOver,50)):(P(document,"mouseup",n._onDrop),P(document,"touchend",n._onDrop),P(document,"touchcancel",n._onDrop),r&&(r.effectAllowed="move",s.setData&&s.setData.call(n,r,y)),j(document,"drop",n),A(y,"transform","translateZ(0)")),bt=!0,n._dragStartId=fn(n._dragStarted.bind(n,e,t)),j(document,"selectstart",n),Lt=!0,window.getSelection().removeAllRanges(),Ht&&A(document.body,"user-select","none")},_onDragOver:function(t){var e=this.el,n=t.target,r,s,l,f=this.options,d=f.group,u=w.active,_=tn===d,o=f.sort,a=oe||u,c,m=this,p=!1;if(Un)return;function g(q,b){ye(q,m,Ue({evt:t,isOwner:_,axis:c?"vertical":"horizontal",revert:l,dragRect:r,targetRect:s,canSort:o,fromSortable:a,target:n,completed:v,onMove:function(se,tt){return rn(F,e,y,r,se,J(se),t,tt)},changed:T},b))}function h(){g("dragOverAnimationCapture"),m.captureAnimationState(),m!==a&&a.captureAnimationState()}function v(q){return g("dragOverCompleted",{insertion:q}),q&&(_?u._hideClone():u._showClone(m),m!==a&&(Ae(y,oe?oe.options.ghostClass:u.options.ghostClass,!1),Ae(y,f.ghostClass,!0)),oe!==m&&m!==w.active?oe=m:m===w.active&&oe&&(oe=null),a===m&&(m._ignoreWhileAnimating=n),m.animateAll(function(){g("dragOverAnimationComplete"),m._ignoreWhileAnimating=null}),m!==a&&(a.animateAll(),a._ignoreWhileAnimating=null)),(n===y&&!y.animated||n===e&&!n.animated)&&(yt=null),!f.dragoverBubble&&!t.rootEl&&n!==document&&(y.parentNode[Te]._isOutsideThisEl(t.target),!q&&ut(t)),!f.dragoverBubble&&t.stopPropagation&&t.stopPropagation(),p=!0}function T(){Ee=Pe(y),it=Pe(y,f.draggable),me({sortable:m,name:"change",toEl:e,newIndex:Ee,newDraggableIndex:it,originalEvent:t})}if(t.preventDefault!==void 0&&t.cancelable&&t.preventDefault(),n=Le(n,f.draggable,e,!0),g("dragOver"),w.eventCanceled)return p;if(y.contains(t.target)||n.animated&&n.animatingX&&n.animatingY||m._ignoreWhileAnimating===n)return v(!1);if(yn=!1,u&&!f.disabled&&(_?o||(l=G!==F):oe===this||(this.lastPutMode=tn.checkPull(this,u,y,t))&&d.checkPut(this,u,y,t))){if(c=this._getDirection(t,n)==="vertical",r=J(y),g("dragOverValid"),w.eventCanceled)return p;if(l)return G=F,h(),this._hideClone(),g("revert"),w.eventCanceled||(ft?F.insertBefore(y,ft):F.appendChild(y)),v(!0);var S=eo(e,f.draggable);if(!S||Mi(t,c,this)&&!S.animated){if(S===y)return v(!1);if(S&&e===t.target&&(n=S),n&&(s=J(n)),rn(F,e,y,r,n,s,t,!!n)!==!1)return h(),S&&S.nextSibling?e.insertBefore(y,S.nextSibling):e.appendChild(y),G=e,T(),v(!0)}else if(S&&Oi(t,c,this)){var D=It(e,0,f,!0);if(D===y)return v(!1);if(n=D,s=J(n),rn(F,e,y,r,n,s,t,!1)!==!1)return h(),e.insertBefore(y,D),G=e,T(),v(!0)}else if(n.parentNode===e){s=J(n);var M=0,$,Y=y.parentNode!==e,E=!Ci(y.animated&&y.toRect||r,n.animated&&n.toRect||s,c),re=c?"top":"left",V=po(n,"top","top")||po(y,"top","top"),X=V?V.scrollTop:void 0;yt!==n&&($=s[re],qt=!1,nn=!E&&f.invertSwap||Y),M=ki(t,n,s,c,E?1:f.swapThreshold,f.invertedSwapThreshold==null?f.swapThreshold:f.invertedSwapThreshold,nn,yt===n);var K;if(M!==0){var k=Pe(y);do k-=M,K=G.children[k];while(K&&(A(K,"display")==="none"||K===x))}if(M===0||K===n)return v(!1);yt=n,Xt=M;var B=n.nextElementSibling,W=!1;W=M===1;var Se=rn(F,e,y,r,n,s,t,W);if(Se!==!1)return(Se===1||Se===-1)&&(W=Se===1),Un=!0,setTimeout(ji,30),h(),W&&!B?e.appendChild(y):n.parentNode.insertBefore(y,W?B:n),V&&$o(V,0,X-V.scrollTop),G=y.parentNode,$!==void 0&&!nn&&(mn=Math.abs($-J(n)[re])),T(),v(!0)}if(e.contains(y))return v(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){P(document,"mousemove",this._onTouchMove),P(document,"touchmove",this._onTouchMove),P(document,"pointermove",this._onTouchMove),P(document,"dragover",ut),P(document,"mousemove",ut),P(document,"touchmove",ut)},_offUpEvents:function(){var t=this.el.ownerDocument;P(t,"mouseup",this._onDrop),P(t,"touchend",this._onDrop),P(t,"pointerup",this._onDrop),P(t,"pointercancel",this._onDrop),P(t,"touchcancel",this._onDrop),P(document,"selectstart",this)},_onDrop:function(t){var e=this.el,n=this.options;if(Ee=Pe(y),it=Pe(y,n.draggable),ye("drop",this,{evt:t}),G=y&&y.parentNode,Ee=Pe(y),it=Pe(y,n.draggable),w.eventCanceled){this._nulling();return}bt=!1,nn=!1,qt=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),Yn(this.cloneId),Yn(this._dragStartId),this.nativeDraggable&&(P(document,"drop",this),P(e,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),Ht&&A(document.body,"user-select",""),A(y,"transform",""),t&&(Lt&&(t.cancelable&&t.preventDefault(),!n.dropBubble&&t.stopPropagation()),x&&x.parentNode&&x.parentNode.removeChild(x),(F===G||oe&&oe.lastPutMode!=="clone")&&H&&H.parentNode&&H.parentNode.removeChild(H),y&&(this.nativeDraggable&&P(y,"dragend",this),Rn(y),y.style["will-change"]="",Lt&&!bt&&Ae(y,oe?oe.options.ghostClass:this.options.ghostClass,!1),Ae(y,this.options.chosenClass,!1),me({sortable:this,name:"unchoose",toEl:G,newIndex:null,newDraggableIndex:null,originalEvent:t}),F!==G?(Ee>=0&&(me({rootEl:G,name:"add",toEl:G,fromEl:F,originalEvent:t}),me({sortable:this,name:"remove",toEl:G,originalEvent:t}),me({rootEl:G,name:"sort",toEl:G,fromEl:F,originalEvent:t}),me({sortable:this,name:"sort",toEl:G,originalEvent:t})),oe&&oe.save()):Ee!==Et&&Ee>=0&&(me({sortable:this,name:"update",toEl:G,originalEvent:t}),me({sortable:this,name:"sort",toEl:G,originalEvent:t})),w.active&&((Ee==null||Ee===-1)&&(Ee=Et,it=Vt),me({sortable:this,name:"end",toEl:G,originalEvent:t}),this.save()))),this._nulling()},_nulling:function(){ye("nulling",this),F=y=G=x=ft=H=dn=rt=ct=ke=Lt=Ee=it=Et=Vt=yt=Xt=oe=tn=w.dragged=w.ghost=w.clone=w.active=null,bn.forEach(function(t){t.checked=!0}),bn.length=Mn=kn=0},handleEvent:function(t){switch(t.type){case"drop":case"dragend":this._onDrop(t);break;case"dragenter":case"dragover":y&&(this._onDragOver(t),Pi(t));break;case"selectstart":t.preventDefault();break}},toArray:function(){for(var t=[],e,n=this.el.children,r=0,s=n.length,l=this.options;r<s;r++)e=n[r],Le(e,l.draggable,this.el,!1)&&t.push(e.getAttribute(l.dataIdAttr)||Ri(e));return t},sort:function(t,e){var n={},r=this.el;this.toArray().forEach(function(s,l){var f=r.children[l];Le(f,this.options.draggable,r,!1)&&(n[s]=f)},this),e&&this.captureAnimationState(),t.forEach(function(s){n[s]&&(r.removeChild(n[s]),r.appendChild(n[s]))}),e&&this.animateAll()},save:function(){var t=this.options.store;t&&t.set&&t.set(this)},closest:function(t,e){return Le(t,e||this.options.draggable,this.el,!1)},option:function(t,e){var n=this.options;if(e===void 0)return n[t];var r=Jt.modifyOption(this,t,e);typeof r<"u"?n[t]=r:n[t]=e,t==="group"&&qo(n)},destroy:function(){ye("destroy",this);var t=this.el;t[Te]=null,P(t,"mousedown",this._onTapStart),P(t,"touchstart",this._onTapStart),P(t,"pointerdown",this._onTapStart),this.nativeDraggable&&(P(t,"dragover",this),P(t,"dragenter",this)),Array.prototype.forEach.call(t.querySelectorAll("[draggable]"),function(e){e.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),Tn.splice(Tn.indexOf(this.el),1),this.el=t=null},_hideClone:function(){if(!rt){if(ye("hideClone",this),w.eventCanceled)return;A(H,"display","none"),this.options.removeCloneOnHide&&H.parentNode&&H.parentNode.removeChild(H),rt=!0}},_showClone:function(t){if(t.lastPutMode!=="clone"){this._hideClone();return}if(rt){if(ye("showClone",this),w.eventCanceled)return;y.parentNode==F&&!this.options.group.revertClone?F.insertBefore(H,y):ft?F.insertBefore(H,ft):F.appendChild(H),this.options.group.revertClone&&this.animate(y,H),A(H,"display",""),rt=!1}}};function Pi(i){i.dataTransfer&&(i.dataTransfer.dropEffect="move"),i.cancelable&&i.preventDefault()}function rn(i,t,e,n,r,s,l,f){var d,u=i[Te],_=u.options.onMove,o;return window.CustomEvent&&!et&&!Zt?d=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(d=document.createEvent("Event"),d.initEvent("move",!0,!0)),d.to=t,d.from=i,d.dragged=e,d.draggedRect=n,d.related=r||t,d.relatedRect=s||J(t),d.willInsertAfter=f,d.originalEvent=l,i.dispatchEvent(d),_&&(o=_.call(u,d,l)),o}function Rn(i){i.draggable=!1}function ji(){Un=!1}function Oi(i,t,e){var n=J(It(e.el,0,e.options,!0)),r=Go(e.el,e.options,x),s=10;return t?i.clientX<r.left-s||i.clientY<n.top&&i.clientX<n.right:i.clientY<r.top-s||i.clientY<n.bottom&&i.clientX<n.left}function Mi(i,t,e){var n=J(eo(e.el,e.options.draggable)),r=Go(e.el,e.options,x),s=10;return t?i.clientX>r.right+s||i.clientY>n.bottom&&i.clientX>n.left:i.clientY>r.bottom+s||i.clientX>n.right&&i.clientY>n.top}function ki(i,t,e,n,r,s,l,f){var d=n?i.clientY:i.clientX,u=n?e.height:e.width,_=n?e.top:e.left,o=n?e.bottom:e.right,a=!1;if(!l){if(f&&mn<u*r){if(!qt&&(Xt===1?d>_+u*s/2:d<o-u*s/2)&&(qt=!0),qt)a=!0;else if(Xt===1?d<_+mn:d>o-mn)return-Xt}else if(d>_+u*(1-r)/2&&d<o-u*(1-r)/2)return Ni(t)}return a=a||l,a&&(d<_+u*s/2||d>o-u*s/2)?d>_+u/2?1:-1:0}function Ni(i){return Pe(y)<Pe(i)?1:-1}function Ri(i){for(var t=i.tagName+i.className+i.src+i.href+i.textContent,e=t.length,n=0;e--;)n+=t.charCodeAt(e);return n.toString(36)}function Li(i){bn.length=0;for(var t=i.getElementsByTagName("input"),e=t.length;e--;){var n=t[e];n.checked&&bn.push(n)}}function fn(i){return setTimeout(i,0)}function Yn(i){return clearTimeout(i)}Sn&&j(document,"touchmove",function(i){(w.active||bt)&&i.cancelable&&i.preventDefault()});w.utils={on:j,off:P,css:A,find:Bo,is:function(t,e){return!!Le(t,e,t,!1)},extend:yi,throttle:Fo,closest:Le,toggleClass:Ae,clone:Ho,index:Pe,nextTick:fn,cancelNextTick:Yn,detectDirection:Xo,getChild:It,expando:Te};w.get=function(i){return i[Te]};w.mount=function(){for(var i=arguments.length,t=new Array(i),e=0;e<i;e++)t[e]=arguments[e];t[0].constructor===Array&&(t=t[0]),t.forEach(function(n){if(!n.prototype||!n.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(n));n.utils&&(w.utils=Ue(Ue({},w.utils),n.utils)),Jt.mount(n)})};w.create=function(i,t){return new w(i,t)};w.version=gi;var Z=[],Bt,Wn,Zn=!1,Ln,Bn,wn,Ft;function Bi(){function i(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var t in this)t.charAt(0)==="_"&&typeof this[t]=="function"&&(this[t]=this[t].bind(this))}return i.prototype={dragStarted:function(e){var n=e.originalEvent;this.sortable.nativeDraggable?j(document,"dragover",this._handleAutoScroll):this.options.supportPointer?j(document,"pointermove",this._handleFallbackAutoScroll):n.touches?j(document,"touchmove",this._handleFallbackAutoScroll):j(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(e){var n=e.originalEvent;!this.options.dragOverBubble&&!n.rootEl&&this._handleAutoScroll(n)},drop:function(){this.sortable.nativeDraggable?P(document,"dragover",this._handleAutoScroll):(P(document,"pointermove",this._handleFallbackAutoScroll),P(document,"touchmove",this._handleFallbackAutoScroll),P(document,"mousemove",this._handleFallbackAutoScroll)),yo(),pn(),Ti()},nulling:function(){wn=Wn=Bt=Zn=Ft=Ln=Bn=null,Z.length=0},_handleFallbackAutoScroll:function(e){this._handleAutoScroll(e,!0)},_handleAutoScroll:function(e,n){var r=this,s=(e.touches?e.touches[0]:e).clientX,l=(e.touches?e.touches[0]:e).clientY,f=document.elementFromPoint(s,l);if(wn=e,n||this.options.forceAutoScrollFallback||Zt||et||Ht){Fn(e,this.options,f,n);var d=st(f,!0);Zn&&(!Ft||s!==Ln||l!==Bn)&&(Ft&&yo(),Ft=setInterval(function(){var u=st(document.elementFromPoint(s,l),!0);u!==d&&(d=u,pn()),Fn(e,r.options,u,n)},10),Ln=s,Bn=l)}else{if(!this.options.bubbleScroll||st(f,!0)===qe()){pn();return}Fn(e,this.options,st(f,!1),!1)}}},ze(i,{pluginName:"scroll",initializeByDefault:!0})}function pn(){Z.forEach(function(i){clearInterval(i.pid)}),Z=[]}function yo(){clearInterval(Ft)}var Fn=Fo(function(i,t,e,n){if(t.scroll){var r=(i.touches?i.touches[0]:i).clientX,s=(i.touches?i.touches[0]:i).clientY,l=t.scrollSensitivity,f=t.scrollSpeed,d=qe(),u=!1,_;Wn!==e&&(Wn=e,pn(),Bt=t.scroll,_=t.scrollFn,Bt===!0&&(Bt=st(e,!0)));var o=0,a=Bt;do{var c=a,m=J(c),p=m.top,g=m.bottom,h=m.left,v=m.right,T=m.width,S=m.height,D=void 0,M=void 0,$=c.scrollWidth,Y=c.scrollHeight,E=A(c),re=c.scrollLeft,V=c.scrollTop;c===d?(D=T<$&&(E.overflowX==="auto"||E.overflowX==="scroll"||E.overflowX==="visible"),M=S<Y&&(E.overflowY==="auto"||E.overflowY==="scroll"||E.overflowY==="visible")):(D=T<$&&(E.overflowX==="auto"||E.overflowX==="scroll"),M=S<Y&&(E.overflowY==="auto"||E.overflowY==="scroll"));var X=D&&(Math.abs(v-r)<=l&&re+T<$)-(Math.abs(h-r)<=l&&!!re),K=M&&(Math.abs(g-s)<=l&&V+S<Y)-(Math.abs(p-s)<=l&&!!V);if(!Z[o])for(var k=0;k<=o;k++)Z[k]||(Z[k]={});(Z[o].vx!=X||Z[o].vy!=K||Z[o].el!==c)&&(Z[o].el=c,Z[o].vx=X,Z[o].vy=K,clearInterval(Z[o].pid),(X!=0||K!=0)&&(u=!0,Z[o].pid=setInterval((function(){n&&this.layer===0&&w.active._onTouchMove(wn);var B=Z[this.layer].vy?Z[this.layer].vy*f:0,W=Z[this.layer].vx?Z[this.layer].vx*f:0;typeof _=="function"&&_.call(w.dragged.parentNode[Te],W,B,i,wn,Z[this.layer].el)!=="continue"||$o(Z[this.layer].el,W,B)}).bind({layer:o}),24))),o++}while(t.bubbleScroll&&a!==d&&(a=st(a,!1)));Zn=u}},30),Wo=function(t){var e=t.originalEvent,n=t.putSortable,r=t.dragEl,s=t.activeSortable,l=t.dispatchSortableEvent,f=t.hideGhostForTarget,d=t.unhideGhostForTarget;if(e){var u=n||s;f();var _=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:e,o=document.elementFromPoint(_.clientX,_.clientY);d(),u&&!u.el.contains(o)&&(l("spill"),this.onSpill({dragEl:r,putSortable:n}))}};function to(){}to.prototype={startIndex:null,dragStart:function(t){var e=t.oldDraggableIndex;this.startIndex=e},onSpill:function(t){var e=t.dragEl,n=t.putSortable;this.sortable.captureAnimationState(),n&&n.captureAnimationState();var r=It(this.sortable.el,this.startIndex,this.options);r?this.sortable.el.insertBefore(e,r):this.sortable.el.appendChild(e),this.sortable.animateAll(),n&&n.animateAll()},drop:Wo};ze(to,{pluginName:"revertOnSpill"});function no(){}no.prototype={onSpill:function(t){var e=t.dragEl,n=t.putSortable,r=n||this.sortable;r.captureAnimationState(),e.parentNode&&e.parentNode.removeChild(e),r.animateAll()},drop:Wo};ze(no,{pluginName:"removeOnSpill"});w.mount(new Bi);w.mount(no,to);class Fi{constructor(){this.steps=[]}visualizeCarryOver(t,e){const n=[],r=t+e;return n.push({action:"show_first",value:t,coins:this.convertToCoins(t),message:`まず ${t}円 があります`}),n.push({action:"show_second",value:e,coins:this.convertToCoins(e),message:`つぎに ${e}円 をたします`}),r<100?this.visualizeTwoDigitCarryOver(t,e,r,n):r<1e3?this.visualizeThreeDigitCarryOver(t,e,r,n):this.visualizeFourDigitCarryOver(t,e,r,n)}visualizeTwoDigitCarryOver(t,e,n,r){const s=t%10,l=e%10;if(s+l>=10){const d=10-s;r.push({action:"make_ten",value:d,message:`${s} に ${d} をたして 10 をつくります`}),r.push({action:"convert_to_ten",message:"10まいの1円が1まいの10円になります！"});const u=l-d;u>0&&r.push({action:"add_remainder",value:u,message:`のこりの ${u}円 をたします`}),r.push({action:"final_result",value:n,message:`ごうけい ${n}円 です！`})}else r.push({action:"simple_add",value:n,message:`${t} + ${e} = ${n}円 です！`});return r}visualizeThreeDigitCarryOver(t,e,n,r){const s=Math.floor(t/100),l=Math.floor(t%100/10),f=t%10,d=Math.floor(e/100),u=Math.floor(e%100/10),_=e%10,o=f+_;if(o>=10){const m=Math.floor(o/10);r.push({action:"ones_carry",message:`1の位: ${f} + ${_} = ${o}、${m}を10の位に繰り上がり`})}else r.push({action:"ones_simple",message:`1の位: ${f} + ${_} = ${o}`});const a=l+u+(o>=10?1:0);if(a>=10){const m=Math.floor(a/10);r.push({action:"tens_carry",message:`10の位: ${l} + ${u}${o>=10?" + 1(繰り上がり)":""} = ${a}、${m}を100の位に繰り上がり`})}else r.push({action:"tens_simple",message:`10の位: ${l} + ${u}${o>=10?" + 1(繰り上がり)":""} = ${a}`});const c=s+d+(a>=10?1:0);return c>0&&r.push({action:"hundreds_result",message:`100の位: ${s} + ${d}${a>=10?" + 1(繰り上がり)":""} = ${c}`}),r.push({action:"final_result",value:n,message:`ごうけい ${n}円 です！`}),r}visualizeFourDigitCarryOver(t,e,n,r){const s=Math.floor(t/1e3),l=Math.floor(t%1e3/100),f=Math.floor(t%100/10),d=t%10,u=Math.floor(e/1e3),_=Math.floor(e%1e3/100),o=Math.floor(e%100/10),a=e%10;let c=0,m=0,p=0;const g=d+a;g>=10?(c=Math.floor(g/10),r.push({action:"ones_carry",message:`1の位: ${d} + ${a} = ${g}、${c}を10の位に繰り上がり`})):r.push({action:"ones_simple",message:`1の位: ${d} + ${a} = ${g}`});const h=f+o+c;h>=10?(m=Math.floor(h/10),r.push({action:"tens_carry",message:`10の位: ${f} + ${o}${c>0?" + "+c+"(繰り上がり)":""} = ${h}、${m}を100の位に繰り上がり`})):r.push({action:"tens_simple",message:`10の位: ${f} + ${o}${c>0?" + "+c+"(繰り上がり)":""} = ${h}`});const v=l+_+m;v>=10?(p=Math.floor(v/10),r.push({action:"hundreds_carry",message:`100の位: ${l} + ${_}${m>0?" + "+m+"(繰り上がり)":""} = ${v}、${p}を1000の位に繰り上がり`})):r.push({action:"hundreds_simple",message:`100の位: ${l} + ${_}${m>0?" + "+m+"(繰り上がり)":""} = ${v}`});const T=s+u+p;return T>0&&r.push({action:"thousands_result",message:`1000の位: ${s} + ${u}${p>0?" + "+p+"(繰り上がり)":""} = ${T}`}),r.push({action:"final_result",value:n,message:`ごうけい ${n}円 です！`}),r}convertToCoins(t){const e=[];let n=t;const r=Math.floor(n/1e3);for(let _=0;_<r;_++)e.push({type:"1000",value:1e3});n=n%1e3;const s=Math.floor(n/500);for(let _=0;_<s;_++)e.push({type:"500",value:500});n=n%500;const l=Math.floor(n/100);for(let _=0;_<l;_++)e.push({type:"100",value:100});n=n%100;const f=Math.floor(n/50);for(let _=0;_<f;_++)e.push({type:"50",value:50});n=n%50;const d=Math.floor(n/10);for(let _=0;_<d;_++)e.push({type:"10",value:10});n=n%10;const u=Math.floor(n/5);for(let _=0;_<u;_++)e.push({type:"5",value:5});n=n%5;for(let _=0;_<n;_++)e.push({type:"1",value:1});return e}generateCoinsForAmount(t){const e=[];let n=t;const r=Math.floor(n/10);for(let s=0;s<r;s++)e.push(this.createCoin(10));n=n%10;for(let s=0;s<n;s++)e.push(this.createCoin(1));for(let s=0;s<3;s++)e.push(this.createCoin(10));for(let s=0;s<6;s++)e.push(this.createCoin(1));return e}createCoin(t){const e=document.createElement("div");return e.className=`coin coin-${t}`,e.draggable=!0,e.dataset.value=t,e.textContent=t,e}checkCarryOverPattern(t,e){const n=t%10,r=e%10;return n+r>=10}getHint(t,e,n){const s=t+e-n;return s===0?"せいかいです！":s>0?`あと ${s}円 たりません`:`${Math.abs(s)}円 おおすぎます`}generateProblemSet(t=1){const e=[];switch(t){case 1:e.push({items:[{name:"りんご",price:7,emoji:"🍎"},{name:"バナナ",price:5,emoji:"🍌"}]},{items:[{name:"えんぴつ",price:6,emoji:"✏️"},{name:"けしゴム",price:8,emoji:"🧽"}]},{items:[{name:"パン",price:9,emoji:"🍞"},{name:"ぎゅうにゅう",price:4,emoji:"🥛"}]});break;case 2:e.push({items:[{name:"ケーキ",price:8,emoji:"🍰"},{name:"ジュース",price:7,emoji:"🧃"}]},{items:[{name:"ボール",price:9,emoji:"⚽"},{name:"ほん",price:6,emoji:"📚"}]});break}return e}}var kt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},$n={};/*!
 *  howler.js v2.2.4
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */var To;function $i(){return To||(To=1,function(i){(function(){var t=function(){this.init()};t.prototype={init:function(){var o=this||e;return o._counter=1e3,o._html5AudioPool=[],o.html5PoolSize=10,o._codecs={},o._howls=[],o._muted=!1,o._volume=1,o._canPlayEvent="canplaythrough",o._navigator=typeof window<"u"&&window.navigator?window.navigator:null,o.masterGain=null,o.noAudio=!1,o.usingWebAudio=!0,o.autoSuspend=!0,o.ctx=null,o.autoUnlock=!0,o._setup(),o},volume:function(o){var a=this||e;if(o=parseFloat(o),a.ctx||_(),typeof o<"u"&&o>=0&&o<=1){if(a._volume=o,a._muted)return a;a.usingWebAudio&&a.masterGain.gain.setValueAtTime(o,e.ctx.currentTime);for(var c=0;c<a._howls.length;c++)if(!a._howls[c]._webAudio)for(var m=a._howls[c]._getSoundIds(),p=0;p<m.length;p++){var g=a._howls[c]._soundById(m[p]);g&&g._node&&(g._node.volume=g._volume*o)}return a}return a._volume},mute:function(o){var a=this||e;a.ctx||_(),a._muted=o,a.usingWebAudio&&a.masterGain.gain.setValueAtTime(o?0:a._volume,e.ctx.currentTime);for(var c=0;c<a._howls.length;c++)if(!a._howls[c]._webAudio)for(var m=a._howls[c]._getSoundIds(),p=0;p<m.length;p++){var g=a._howls[c]._soundById(m[p]);g&&g._node&&(g._node.muted=o?!0:g._muted)}return a},stop:function(){for(var o=this||e,a=0;a<o._howls.length;a++)o._howls[a].stop();return o},unload:function(){for(var o=this||e,a=o._howls.length-1;a>=0;a--)o._howls[a].unload();return o.usingWebAudio&&o.ctx&&typeof o.ctx.close<"u"&&(o.ctx.close(),o.ctx=null,_()),o},codecs:function(o){return(this||e)._codecs[o.replace(/^x-/,"")]},_setup:function(){var o=this||e;if(o.state=o.ctx&&o.ctx.state||"suspended",o._autoSuspend(),!o.usingWebAudio)if(typeof Audio<"u")try{var a=new Audio;typeof a.oncanplaythrough>"u"&&(o._canPlayEvent="canplay")}catch{o.noAudio=!0}else o.noAudio=!0;try{var a=new Audio;a.muted&&(o.noAudio=!0)}catch{}return o.noAudio||o._setupCodecs(),o},_setupCodecs:function(){var o=this||e,a=null;try{a=typeof Audio<"u"?new Audio:null}catch{return o}if(!a||typeof a.canPlayType!="function")return o;var c=a.canPlayType("audio/mpeg;").replace(/^no$/,""),m=o._navigator?o._navigator.userAgent:"",p=m.match(/OPR\/(\d+)/g),g=p&&parseInt(p[0].split("/")[1],10)<33,h=m.indexOf("Safari")!==-1&&m.indexOf("Chrome")===-1,v=m.match(/Version\/(.*?) /),T=h&&v&&parseInt(v[1],10)<15;return o._codecs={mp3:!!(!g&&(c||a.canPlayType("audio/mp3;").replace(/^no$/,""))),mpeg:!!c,opus:!!a.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!a.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!a.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(a.canPlayType('audio/wav; codecs="1"')||a.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!a.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!a.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(a.canPlayType("audio/x-m4a;")||a.canPlayType("audio/m4a;")||a.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(a.canPlayType("audio/x-m4b;")||a.canPlayType("audio/m4b;")||a.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(a.canPlayType("audio/x-mp4;")||a.canPlayType("audio/mp4;")||a.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!(!T&&a.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!!(!T&&a.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!a.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(a.canPlayType("audio/x-flac;")||a.canPlayType("audio/flac;")).replace(/^no$/,"")},o},_unlockAudio:function(){var o=this||e;if(!(o._audioUnlocked||!o.ctx)){o._audioUnlocked=!1,o.autoUnlock=!1,!o._mobileUnloaded&&o.ctx.sampleRate!==44100&&(o._mobileUnloaded=!0,o.unload()),o._scratchBuffer=o.ctx.createBuffer(1,1,22050);var a=function(c){for(;o._html5AudioPool.length<o.html5PoolSize;)try{var m=new Audio;m._unlocked=!0,o._releaseHtml5Audio(m)}catch{o.noAudio=!0;break}for(var p=0;p<o._howls.length;p++)if(!o._howls[p]._webAudio)for(var g=o._howls[p]._getSoundIds(),h=0;h<g.length;h++){var v=o._howls[p]._soundById(g[h]);v&&v._node&&!v._node._unlocked&&(v._node._unlocked=!0,v._node.load())}o._autoResume();var T=o.ctx.createBufferSource();T.buffer=o._scratchBuffer,T.connect(o.ctx.destination),typeof T.start>"u"?T.noteOn(0):T.start(0),typeof o.ctx.resume=="function"&&o.ctx.resume(),T.onended=function(){T.disconnect(0),o._audioUnlocked=!0,document.removeEventListener("touchstart",a,!0),document.removeEventListener("touchend",a,!0),document.removeEventListener("click",a,!0),document.removeEventListener("keydown",a,!0);for(var S=0;S<o._howls.length;S++)o._howls[S]._emit("unlock")}};return document.addEventListener("touchstart",a,!0),document.addEventListener("touchend",a,!0),document.addEventListener("click",a,!0),document.addEventListener("keydown",a,!0),o}},_obtainHtml5Audio:function(){var o=this||e;if(o._html5AudioPool.length)return o._html5AudioPool.pop();var a=new Audio().play();return a&&typeof Promise<"u"&&(a instanceof Promise||typeof a.then=="function")&&a.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(o){var a=this||e;return o._unlocked&&a._html5AudioPool.push(o),a},_autoSuspend:function(){var o=this;if(!(!o.autoSuspend||!o.ctx||typeof o.ctx.suspend>"u"||!e.usingWebAudio)){for(var a=0;a<o._howls.length;a++)if(o._howls[a]._webAudio){for(var c=0;c<o._howls[a]._sounds.length;c++)if(!o._howls[a]._sounds[c]._paused)return o}return o._suspendTimer&&clearTimeout(o._suspendTimer),o._suspendTimer=setTimeout(function(){if(o.autoSuspend){o._suspendTimer=null,o.state="suspending";var m=function(){o.state="suspended",o._resumeAfterSuspend&&(delete o._resumeAfterSuspend,o._autoResume())};o.ctx.suspend().then(m,m)}},3e4),o}},_autoResume:function(){var o=this;if(!(!o.ctx||typeof o.ctx.resume>"u"||!e.usingWebAudio))return o.state==="running"&&o.ctx.state!=="interrupted"&&o._suspendTimer?(clearTimeout(o._suspendTimer),o._suspendTimer=null):o.state==="suspended"||o.state==="running"&&o.ctx.state==="interrupted"?(o.ctx.resume().then(function(){o.state="running";for(var a=0;a<o._howls.length;a++)o._howls[a]._emit("resume")}),o._suspendTimer&&(clearTimeout(o._suspendTimer),o._suspendTimer=null)):o.state==="suspending"&&(o._resumeAfterSuspend=!0),o}};var e=new t,n=function(o){var a=this;if(!o.src||o.src.length===0){console.error("An array of source files must be passed with any new Howl.");return}a.init(o)};n.prototype={init:function(o){var a=this;return e.ctx||_(),a._autoplay=o.autoplay||!1,a._format=typeof o.format!="string"?o.format:[o.format],a._html5=o.html5||!1,a._muted=o.mute||!1,a._loop=o.loop||!1,a._pool=o.pool||5,a._preload=typeof o.preload=="boolean"||o.preload==="metadata"?o.preload:!0,a._rate=o.rate||1,a._sprite=o.sprite||{},a._src=typeof o.src!="string"?o.src:[o.src],a._volume=o.volume!==void 0?o.volume:1,a._xhr={method:o.xhr&&o.xhr.method?o.xhr.method:"GET",headers:o.xhr&&o.xhr.headers?o.xhr.headers:null,withCredentials:o.xhr&&o.xhr.withCredentials?o.xhr.withCredentials:!1},a._duration=0,a._state="unloaded",a._sounds=[],a._endTimers={},a._queue=[],a._playLock=!1,a._onend=o.onend?[{fn:o.onend}]:[],a._onfade=o.onfade?[{fn:o.onfade}]:[],a._onload=o.onload?[{fn:o.onload}]:[],a._onloaderror=o.onloaderror?[{fn:o.onloaderror}]:[],a._onplayerror=o.onplayerror?[{fn:o.onplayerror}]:[],a._onpause=o.onpause?[{fn:o.onpause}]:[],a._onplay=o.onplay?[{fn:o.onplay}]:[],a._onstop=o.onstop?[{fn:o.onstop}]:[],a._onmute=o.onmute?[{fn:o.onmute}]:[],a._onvolume=o.onvolume?[{fn:o.onvolume}]:[],a._onrate=o.onrate?[{fn:o.onrate}]:[],a._onseek=o.onseek?[{fn:o.onseek}]:[],a._onunlock=o.onunlock?[{fn:o.onunlock}]:[],a._onresume=[],a._webAudio=e.usingWebAudio&&!a._html5,typeof e.ctx<"u"&&e.ctx&&e.autoUnlock&&e._unlockAudio(),e._howls.push(a),a._autoplay&&a._queue.push({event:"play",action:function(){a.play()}}),a._preload&&a._preload!=="none"&&a.load(),a},load:function(){var o=this,a=null;if(e.noAudio){o._emit("loaderror",null,"No audio support.");return}typeof o._src=="string"&&(o._src=[o._src]);for(var c=0;c<o._src.length;c++){var m,p;if(o._format&&o._format[c])m=o._format[c];else{if(p=o._src[c],typeof p!="string"){o._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}m=/^data:audio\/([^;,]+);/i.exec(p),m||(m=/\.([^.]+)$/.exec(p.split("?",1)[0])),m&&(m=m[1].toLowerCase())}if(m||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),m&&e.codecs(m)){a=o._src[c];break}}if(!a){o._emit("loaderror",null,"No codec support for selected audio sources.");return}return o._src=a,o._state="loading",window.location.protocol==="https:"&&a.slice(0,5)==="http:"&&(o._html5=!0,o._webAudio=!1),new r(o),o._webAudio&&l(o),o},play:function(o,a){var c=this,m=null;if(typeof o=="number")m=o,o=null;else{if(typeof o=="string"&&c._state==="loaded"&&!c._sprite[o])return null;if(typeof o>"u"&&(o="__default",!c._playLock)){for(var p=0,g=0;g<c._sounds.length;g++)c._sounds[g]._paused&&!c._sounds[g]._ended&&(p++,m=c._sounds[g]._id);p===1?o=null:m=null}}var h=m?c._soundById(m):c._inactiveSound();if(!h)return null;if(m&&!o&&(o=h._sprite||"__default"),c._state!=="loaded"){h._sprite=o,h._ended=!1;var v=h._id;return c._queue.push({event:"play",action:function(){c.play(v)}}),v}if(m&&!h._paused)return a||c._loadQueue("play"),h._id;c._webAudio&&e._autoResume();var T=Math.max(0,h._seek>0?h._seek:c._sprite[o][0]/1e3),S=Math.max(0,(c._sprite[o][0]+c._sprite[o][1])/1e3-T),D=S*1e3/Math.abs(h._rate),M=c._sprite[o][0]/1e3,$=(c._sprite[o][0]+c._sprite[o][1])/1e3;h._sprite=o,h._ended=!1;var Y=function(){h._paused=!1,h._seek=T,h._start=M,h._stop=$,h._loop=!!(h._loop||c._sprite[o][2])};if(T>=$){c._ended(h);return}var E=h._node;if(c._webAudio){var re=function(){c._playLock=!1,Y(),c._refreshBuffer(h);var k=h._muted||c._muted?0:h._volume;E.gain.setValueAtTime(k,e.ctx.currentTime),h._playStart=e.ctx.currentTime,typeof E.bufferSource.start>"u"?h._loop?E.bufferSource.noteGrainOn(0,T,86400):E.bufferSource.noteGrainOn(0,T,S):h._loop?E.bufferSource.start(0,T,86400):E.bufferSource.start(0,T,S),D!==1/0&&(c._endTimers[h._id]=setTimeout(c._ended.bind(c,h),D)),a||setTimeout(function(){c._emit("play",h._id),c._loadQueue()},0)};e.state==="running"&&e.ctx.state!=="interrupted"?re():(c._playLock=!0,c.once("resume",re),c._clearTimer(h._id))}else{var V=function(){E.currentTime=T,E.muted=h._muted||c._muted||e._muted||E.muted,E.volume=h._volume*e.volume(),E.playbackRate=h._rate;try{var k=E.play();if(k&&typeof Promise<"u"&&(k instanceof Promise||typeof k.then=="function")?(c._playLock=!0,Y(),k.then(function(){c._playLock=!1,E._unlocked=!0,a?c._loadQueue():c._emit("play",h._id)}).catch(function(){c._playLock=!1,c._emit("playerror",h._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),h._ended=!0,h._paused=!0})):a||(c._playLock=!1,Y(),c._emit("play",h._id)),E.playbackRate=h._rate,E.paused){c._emit("playerror",h._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");return}o!=="__default"||h._loop?c._endTimers[h._id]=setTimeout(c._ended.bind(c,h),D):(c._endTimers[h._id]=function(){c._ended(h),E.removeEventListener("ended",c._endTimers[h._id],!1)},E.addEventListener("ended",c._endTimers[h._id],!1))}catch(B){c._emit("playerror",h._id,B)}};E.src==="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"&&(E.src=c._src,E.load());var X=window&&window.ejecta||!E.readyState&&e._navigator.isCocoonJS;if(E.readyState>=3||X)V();else{c._playLock=!0,c._state="loading";var K=function(){c._state="loaded",V(),E.removeEventListener(e._canPlayEvent,K,!1)};E.addEventListener(e._canPlayEvent,K,!1),c._clearTimer(h._id)}}return h._id},pause:function(o){var a=this;if(a._state!=="loaded"||a._playLock)return a._queue.push({event:"pause",action:function(){a.pause(o)}}),a;for(var c=a._getSoundIds(o),m=0;m<c.length;m++){a._clearTimer(c[m]);var p=a._soundById(c[m]);if(p&&!p._paused&&(p._seek=a.seek(c[m]),p._rateSeek=0,p._paused=!0,a._stopFade(c[m]),p._node))if(a._webAudio){if(!p._node.bufferSource)continue;typeof p._node.bufferSource.stop>"u"?p._node.bufferSource.noteOff(0):p._node.bufferSource.stop(0),a._cleanBuffer(p._node)}else(!isNaN(p._node.duration)||p._node.duration===1/0)&&p._node.pause();arguments[1]||a._emit("pause",p?p._id:null)}return a},stop:function(o,a){var c=this;if(c._state!=="loaded"||c._playLock)return c._queue.push({event:"stop",action:function(){c.stop(o)}}),c;for(var m=c._getSoundIds(o),p=0;p<m.length;p++){c._clearTimer(m[p]);var g=c._soundById(m[p]);g&&(g._seek=g._start||0,g._rateSeek=0,g._paused=!0,g._ended=!0,c._stopFade(m[p]),g._node&&(c._webAudio?g._node.bufferSource&&(typeof g._node.bufferSource.stop>"u"?g._node.bufferSource.noteOff(0):g._node.bufferSource.stop(0),c._cleanBuffer(g._node)):(!isNaN(g._node.duration)||g._node.duration===1/0)&&(g._node.currentTime=g._start||0,g._node.pause(),g._node.duration===1/0&&c._clearSound(g._node))),a||c._emit("stop",g._id))}return c},mute:function(o,a){var c=this;if(c._state!=="loaded"||c._playLock)return c._queue.push({event:"mute",action:function(){c.mute(o,a)}}),c;if(typeof a>"u")if(typeof o=="boolean")c._muted=o;else return c._muted;for(var m=c._getSoundIds(a),p=0;p<m.length;p++){var g=c._soundById(m[p]);g&&(g._muted=o,g._interval&&c._stopFade(g._id),c._webAudio&&g._node?g._node.gain.setValueAtTime(o?0:g._volume,e.ctx.currentTime):g._node&&(g._node.muted=e._muted?!0:o),c._emit("mute",g._id))}return c},volume:function(){var o=this,a=arguments,c,m;if(a.length===0)return o._volume;if(a.length===1||a.length===2&&typeof a[1]>"u"){var p=o._getSoundIds(),g=p.indexOf(a[0]);g>=0?m=parseInt(a[0],10):c=parseFloat(a[0])}else a.length>=2&&(c=parseFloat(a[0]),m=parseInt(a[1],10));var h;if(typeof c<"u"&&c>=0&&c<=1){if(o._state!=="loaded"||o._playLock)return o._queue.push({event:"volume",action:function(){o.volume.apply(o,a)}}),o;typeof m>"u"&&(o._volume=c),m=o._getSoundIds(m);for(var v=0;v<m.length;v++)h=o._soundById(m[v]),h&&(h._volume=c,a[2]||o._stopFade(m[v]),o._webAudio&&h._node&&!h._muted?h._node.gain.setValueAtTime(c,e.ctx.currentTime):h._node&&!h._muted&&(h._node.volume=c*e.volume()),o._emit("volume",h._id))}else return h=m?o._soundById(m):o._sounds[0],h?h._volume:0;return o},fade:function(o,a,c,m){var p=this;if(p._state!=="loaded"||p._playLock)return p._queue.push({event:"fade",action:function(){p.fade(o,a,c,m)}}),p;o=Math.min(Math.max(0,parseFloat(o)),1),a=Math.min(Math.max(0,parseFloat(a)),1),c=parseFloat(c),p.volume(o,m);for(var g=p._getSoundIds(m),h=0;h<g.length;h++){var v=p._soundById(g[h]);if(v){if(m||p._stopFade(g[h]),p._webAudio&&!v._muted){var T=e.ctx.currentTime,S=T+c/1e3;v._volume=o,v._node.gain.setValueAtTime(o,T),v._node.gain.linearRampToValueAtTime(a,S)}p._startFadeInterval(v,o,a,c,g[h],typeof m>"u")}}return p},_startFadeInterval:function(o,a,c,m,p,g){var h=this,v=a,T=c-a,S=Math.abs(T/.01),D=Math.max(4,S>0?m/S:m),M=Date.now();o._fadeTo=c,o._interval=setInterval(function(){var $=(Date.now()-M)/m;M=Date.now(),v+=T*$,v=Math.round(v*100)/100,T<0?v=Math.max(c,v):v=Math.min(c,v),h._webAudio?o._volume=v:h.volume(v,o._id,!0),g&&(h._volume=v),(c<a&&v<=c||c>a&&v>=c)&&(clearInterval(o._interval),o._interval=null,o._fadeTo=null,h.volume(c,o._id),h._emit("fade",o._id))},D)},_stopFade:function(o){var a=this,c=a._soundById(o);return c&&c._interval&&(a._webAudio&&c._node.gain.cancelScheduledValues(e.ctx.currentTime),clearInterval(c._interval),c._interval=null,a.volume(c._fadeTo,o),c._fadeTo=null,a._emit("fade",o)),a},loop:function(){var o=this,a=arguments,c,m,p;if(a.length===0)return o._loop;if(a.length===1)if(typeof a[0]=="boolean")c=a[0],o._loop=c;else return p=o._soundById(parseInt(a[0],10)),p?p._loop:!1;else a.length===2&&(c=a[0],m=parseInt(a[1],10));for(var g=o._getSoundIds(m),h=0;h<g.length;h++)p=o._soundById(g[h]),p&&(p._loop=c,o._webAudio&&p._node&&p._node.bufferSource&&(p._node.bufferSource.loop=c,c&&(p._node.bufferSource.loopStart=p._start||0,p._node.bufferSource.loopEnd=p._stop,o.playing(g[h])&&(o.pause(g[h],!0),o.play(g[h],!0)))));return o},rate:function(){var o=this,a=arguments,c,m;if(a.length===0)m=o._sounds[0]._id;else if(a.length===1){var p=o._getSoundIds(),g=p.indexOf(a[0]);g>=0?m=parseInt(a[0],10):c=parseFloat(a[0])}else a.length===2&&(c=parseFloat(a[0]),m=parseInt(a[1],10));var h;if(typeof c=="number"){if(o._state!=="loaded"||o._playLock)return o._queue.push({event:"rate",action:function(){o.rate.apply(o,a)}}),o;typeof m>"u"&&(o._rate=c),m=o._getSoundIds(m);for(var v=0;v<m.length;v++)if(h=o._soundById(m[v]),h){o.playing(m[v])&&(h._rateSeek=o.seek(m[v]),h._playStart=o._webAudio?e.ctx.currentTime:h._playStart),h._rate=c,o._webAudio&&h._node&&h._node.bufferSource?h._node.bufferSource.playbackRate.setValueAtTime(c,e.ctx.currentTime):h._node&&(h._node.playbackRate=c);var T=o.seek(m[v]),S=(o._sprite[h._sprite][0]+o._sprite[h._sprite][1])/1e3-T,D=S*1e3/Math.abs(h._rate);(o._endTimers[m[v]]||!h._paused)&&(o._clearTimer(m[v]),o._endTimers[m[v]]=setTimeout(o._ended.bind(o,h),D)),o._emit("rate",h._id)}}else return h=o._soundById(m),h?h._rate:o._rate;return o},seek:function(){var o=this,a=arguments,c,m;if(a.length===0)o._sounds.length&&(m=o._sounds[0]._id);else if(a.length===1){var p=o._getSoundIds(),g=p.indexOf(a[0]);g>=0?m=parseInt(a[0],10):o._sounds.length&&(m=o._sounds[0]._id,c=parseFloat(a[0]))}else a.length===2&&(c=parseFloat(a[0]),m=parseInt(a[1],10));if(typeof m>"u")return 0;if(typeof c=="number"&&(o._state!=="loaded"||o._playLock))return o._queue.push({event:"seek",action:function(){o.seek.apply(o,a)}}),o;var h=o._soundById(m);if(h)if(typeof c=="number"&&c>=0){var v=o.playing(m);v&&o.pause(m,!0),h._seek=c,h._ended=!1,o._clearTimer(m),!o._webAudio&&h._node&&!isNaN(h._node.duration)&&(h._node.currentTime=c);var T=function(){v&&o.play(m,!0),o._emit("seek",m)};if(v&&!o._webAudio){var S=function(){o._playLock?setTimeout(S,0):T()};setTimeout(S,0)}else T()}else if(o._webAudio){var D=o.playing(m)?e.ctx.currentTime-h._playStart:0,M=h._rateSeek?h._rateSeek-h._seek:0;return h._seek+(M+D*Math.abs(h._rate))}else return h._node.currentTime;return o},playing:function(o){var a=this;if(typeof o=="number"){var c=a._soundById(o);return c?!c._paused:!1}for(var m=0;m<a._sounds.length;m++)if(!a._sounds[m]._paused)return!0;return!1},duration:function(o){var a=this,c=a._duration,m=a._soundById(o);return m&&(c=a._sprite[m._sprite][1]/1e3),c},state:function(){return this._state},unload:function(){for(var o=this,a=o._sounds,c=0;c<a.length;c++)a[c]._paused||o.stop(a[c]._id),o._webAudio||(o._clearSound(a[c]._node),a[c]._node.removeEventListener("error",a[c]._errorFn,!1),a[c]._node.removeEventListener(e._canPlayEvent,a[c]._loadFn,!1),a[c]._node.removeEventListener("ended",a[c]._endFn,!1),e._releaseHtml5Audio(a[c]._node)),delete a[c]._node,o._clearTimer(a[c]._id);var m=e._howls.indexOf(o);m>=0&&e._howls.splice(m,1);var p=!0;for(c=0;c<e._howls.length;c++)if(e._howls[c]._src===o._src||o._src.indexOf(e._howls[c]._src)>=0){p=!1;break}return s&&p&&delete s[o._src],e.noAudio=!1,o._state="unloaded",o._sounds=[],o=null,null},on:function(o,a,c,m){var p=this,g=p["_on"+o];return typeof a=="function"&&g.push(m?{id:c,fn:a,once:m}:{id:c,fn:a}),p},off:function(o,a,c){var m=this,p=m["_on"+o],g=0;if(typeof a=="number"&&(c=a,a=null),a||c)for(g=0;g<p.length;g++){var h=c===p[g].id;if(a===p[g].fn&&h||!a&&h){p.splice(g,1);break}}else if(o)m["_on"+o]=[];else{var v=Object.keys(m);for(g=0;g<v.length;g++)v[g].indexOf("_on")===0&&Array.isArray(m[v[g]])&&(m[v[g]]=[])}return m},once:function(o,a,c){var m=this;return m.on(o,a,c,1),m},_emit:function(o,a,c){for(var m=this,p=m["_on"+o],g=p.length-1;g>=0;g--)(!p[g].id||p[g].id===a||o==="load")&&(setTimeout((function(h){h.call(this,a,c)}).bind(m,p[g].fn),0),p[g].once&&m.off(o,p[g].fn,p[g].id));return m._loadQueue(o),m},_loadQueue:function(o){var a=this;if(a._queue.length>0){var c=a._queue[0];c.event===o&&(a._queue.shift(),a._loadQueue()),o||c.action()}return a},_ended:function(o){var a=this,c=o._sprite;if(!a._webAudio&&o._node&&!o._node.paused&&!o._node.ended&&o._node.currentTime<o._stop)return setTimeout(a._ended.bind(a,o),100),a;var m=!!(o._loop||a._sprite[c][2]);if(a._emit("end",o._id),!a._webAudio&&m&&a.stop(o._id,!0).play(o._id),a._webAudio&&m){a._emit("play",o._id),o._seek=o._start||0,o._rateSeek=0,o._playStart=e.ctx.currentTime;var p=(o._stop-o._start)*1e3/Math.abs(o._rate);a._endTimers[o._id]=setTimeout(a._ended.bind(a,o),p)}return a._webAudio&&!m&&(o._paused=!0,o._ended=!0,o._seek=o._start||0,o._rateSeek=0,a._clearTimer(o._id),a._cleanBuffer(o._node),e._autoSuspend()),!a._webAudio&&!m&&a.stop(o._id,!0),a},_clearTimer:function(o){var a=this;if(a._endTimers[o]){if(typeof a._endTimers[o]!="function")clearTimeout(a._endTimers[o]);else{var c=a._soundById(o);c&&c._node&&c._node.removeEventListener("ended",a._endTimers[o],!1)}delete a._endTimers[o]}return a},_soundById:function(o){for(var a=this,c=0;c<a._sounds.length;c++)if(o===a._sounds[c]._id)return a._sounds[c];return null},_inactiveSound:function(){var o=this;o._drain();for(var a=0;a<o._sounds.length;a++)if(o._sounds[a]._ended)return o._sounds[a].reset();return new r(o)},_drain:function(){var o=this,a=o._pool,c=0,m=0;if(!(o._sounds.length<a)){for(m=0;m<o._sounds.length;m++)o._sounds[m]._ended&&c++;for(m=o._sounds.length-1;m>=0;m--){if(c<=a)return;o._sounds[m]._ended&&(o._webAudio&&o._sounds[m]._node&&o._sounds[m]._node.disconnect(0),o._sounds.splice(m,1),c--)}}},_getSoundIds:function(o){var a=this;if(typeof o>"u"){for(var c=[],m=0;m<a._sounds.length;m++)c.push(a._sounds[m]._id);return c}else return[o]},_refreshBuffer:function(o){var a=this;return o._node.bufferSource=e.ctx.createBufferSource(),o._node.bufferSource.buffer=s[a._src],o._panner?o._node.bufferSource.connect(o._panner):o._node.bufferSource.connect(o._node),o._node.bufferSource.loop=o._loop,o._loop&&(o._node.bufferSource.loopStart=o._start||0,o._node.bufferSource.loopEnd=o._stop||0),o._node.bufferSource.playbackRate.setValueAtTime(o._rate,e.ctx.currentTime),a},_cleanBuffer:function(o){var a=this,c=e._navigator&&e._navigator.vendor.indexOf("Apple")>=0;if(!o.bufferSource)return a;if(e._scratchBuffer&&o.bufferSource&&(o.bufferSource.onended=null,o.bufferSource.disconnect(0),c))try{o.bufferSource.buffer=e._scratchBuffer}catch{}return o.bufferSource=null,a},_clearSound:function(o){var a=/MSIE |Trident\//.test(e._navigator&&e._navigator.userAgent);a||(o.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var r=function(o){this._parent=o,this.init()};r.prototype={init:function(){var o=this,a=o._parent;return o._muted=a._muted,o._loop=a._loop,o._volume=a._volume,o._rate=a._rate,o._seek=0,o._paused=!0,o._ended=!0,o._sprite="__default",o._id=++e._counter,a._sounds.push(o),o.create(),o},create:function(){var o=this,a=o._parent,c=e._muted||o._muted||o._parent._muted?0:o._volume;return a._webAudio?(o._node=typeof e.ctx.createGain>"u"?e.ctx.createGainNode():e.ctx.createGain(),o._node.gain.setValueAtTime(c,e.ctx.currentTime),o._node.paused=!0,o._node.connect(e.masterGain)):e.noAudio||(o._node=e._obtainHtml5Audio(),o._errorFn=o._errorListener.bind(o),o._node.addEventListener("error",o._errorFn,!1),o._loadFn=o._loadListener.bind(o),o._node.addEventListener(e._canPlayEvent,o._loadFn,!1),o._endFn=o._endListener.bind(o),o._node.addEventListener("ended",o._endFn,!1),o._node.src=a._src,o._node.preload=a._preload===!0?"auto":a._preload,o._node.volume=c*e.volume(),o._node.load()),o},reset:function(){var o=this,a=o._parent;return o._muted=a._muted,o._loop=a._loop,o._volume=a._volume,o._rate=a._rate,o._seek=0,o._rateSeek=0,o._paused=!0,o._ended=!0,o._sprite="__default",o._id=++e._counter,o},_errorListener:function(){var o=this;o._parent._emit("loaderror",o._id,o._node.error?o._node.error.code:0),o._node.removeEventListener("error",o._errorFn,!1)},_loadListener:function(){var o=this,a=o._parent;a._duration=Math.ceil(o._node.duration*10)/10,Object.keys(a._sprite).length===0&&(a._sprite={__default:[0,a._duration*1e3]}),a._state!=="loaded"&&(a._state="loaded",a._emit("load"),a._loadQueue()),o._node.removeEventListener(e._canPlayEvent,o._loadFn,!1)},_endListener:function(){var o=this,a=o._parent;a._duration===1/0&&(a._duration=Math.ceil(o._node.duration*10)/10,a._sprite.__default[1]===1/0&&(a._sprite.__default[1]=a._duration*1e3),a._ended(o)),o._node.removeEventListener("ended",o._endFn,!1)}};var s={},l=function(o){var a=o._src;if(s[a]){o._duration=s[a].duration,u(o);return}if(/^data:[^;]+;base64,/.test(a)){for(var c=atob(a.split(",")[1]),m=new Uint8Array(c.length),p=0;p<c.length;++p)m[p]=c.charCodeAt(p);d(m.buffer,o)}else{var g=new XMLHttpRequest;g.open(o._xhr.method,a,!0),g.withCredentials=o._xhr.withCredentials,g.responseType="arraybuffer",o._xhr.headers&&Object.keys(o._xhr.headers).forEach(function(h){g.setRequestHeader(h,o._xhr.headers[h])}),g.onload=function(){var h=(g.status+"")[0];if(h!=="0"&&h!=="2"&&h!=="3"){o._emit("loaderror",null,"Failed loading audio file with status: "+g.status+".");return}d(g.response,o)},g.onerror=function(){o._webAudio&&(o._html5=!0,o._webAudio=!1,o._sounds=[],delete s[a],o.load())},f(g)}},f=function(o){try{o.send()}catch{o.onerror()}},d=function(o,a){var c=function(){a._emit("loaderror",null,"Decoding audio data failed.")},m=function(p){p&&a._sounds.length>0?(s[a._src]=p,u(a,p)):c()};typeof Promise<"u"&&e.ctx.decodeAudioData.length===1?e.ctx.decodeAudioData(o).then(m).catch(c):e.ctx.decodeAudioData(o,m,c)},u=function(o,a){a&&!o._duration&&(o._duration=a.duration),Object.keys(o._sprite).length===0&&(o._sprite={__default:[0,o._duration*1e3]}),o._state!=="loaded"&&(o._state="loaded",o._emit("load"),o._loadQueue())},_=function(){if(e.usingWebAudio){try{typeof AudioContext<"u"?e.ctx=new AudioContext:typeof webkitAudioContext<"u"?e.ctx=new webkitAudioContext:e.usingWebAudio=!1}catch{e.usingWebAudio=!1}e.ctx||(e.usingWebAudio=!1);var o=/iP(hone|od|ad)/.test(e._navigator&&e._navigator.platform),a=e._navigator&&e._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),c=a?parseInt(a[1],10):null;if(o&&c&&c<9){var m=/safari/.test(e._navigator&&e._navigator.userAgent.toLowerCase());e._navigator&&!m&&(e.usingWebAudio=!1)}e.usingWebAudio&&(e.masterGain=typeof e.ctx.createGain>"u"?e.ctx.createGainNode():e.ctx.createGain(),e.masterGain.gain.setValueAtTime(e._muted?0:e._volume,e.ctx.currentTime),e.masterGain.connect(e.ctx.destination)),e._setup()}};i.Howler=e,i.Howl=n,typeof kt<"u"?(kt.HowlerGlobal=t,kt.Howler=e,kt.Howl=n,kt.Sound=r):typeof window<"u"&&(window.HowlerGlobal=t,window.Howler=e,window.Howl=n,window.Sound=r)})();/*!
 *  Spatial Plugin - Adds support for stereo and 3D audio where Web Audio is supported.
 *  
 *  howler.js v2.2.4
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */(function(){HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(e){var n=this;if(!n.ctx||!n.ctx.listener)return n;for(var r=n._howls.length-1;r>=0;r--)n._howls[r].stereo(e);return n},HowlerGlobal.prototype.pos=function(e,n,r){var s=this;if(!s.ctx||!s.ctx.listener)return s;if(n=typeof n!="number"?s._pos[1]:n,r=typeof r!="number"?s._pos[2]:r,typeof e=="number")s._pos=[e,n,r],typeof s.ctx.listener.positionX<"u"?(s.ctx.listener.positionX.setTargetAtTime(s._pos[0],Howler.ctx.currentTime,.1),s.ctx.listener.positionY.setTargetAtTime(s._pos[1],Howler.ctx.currentTime,.1),s.ctx.listener.positionZ.setTargetAtTime(s._pos[2],Howler.ctx.currentTime,.1)):s.ctx.listener.setPosition(s._pos[0],s._pos[1],s._pos[2]);else return s._pos;return s},HowlerGlobal.prototype.orientation=function(e,n,r,s,l,f){var d=this;if(!d.ctx||!d.ctx.listener)return d;var u=d._orientation;if(n=typeof n!="number"?u[1]:n,r=typeof r!="number"?u[2]:r,s=typeof s!="number"?u[3]:s,l=typeof l!="number"?u[4]:l,f=typeof f!="number"?u[5]:f,typeof e=="number")d._orientation=[e,n,r,s,l,f],typeof d.ctx.listener.forwardX<"u"?(d.ctx.listener.forwardX.setTargetAtTime(e,Howler.ctx.currentTime,.1),d.ctx.listener.forwardY.setTargetAtTime(n,Howler.ctx.currentTime,.1),d.ctx.listener.forwardZ.setTargetAtTime(r,Howler.ctx.currentTime,.1),d.ctx.listener.upX.setTargetAtTime(s,Howler.ctx.currentTime,.1),d.ctx.listener.upY.setTargetAtTime(l,Howler.ctx.currentTime,.1),d.ctx.listener.upZ.setTargetAtTime(f,Howler.ctx.currentTime,.1)):d.ctx.listener.setOrientation(e,n,r,s,l,f);else return u;return d},Howl.prototype.init=function(e){return function(n){var r=this;return r._orientation=n.orientation||[1,0,0],r._stereo=n.stereo||null,r._pos=n.pos||null,r._pannerAttr={coneInnerAngle:typeof n.coneInnerAngle<"u"?n.coneInnerAngle:360,coneOuterAngle:typeof n.coneOuterAngle<"u"?n.coneOuterAngle:360,coneOuterGain:typeof n.coneOuterGain<"u"?n.coneOuterGain:0,distanceModel:typeof n.distanceModel<"u"?n.distanceModel:"inverse",maxDistance:typeof n.maxDistance<"u"?n.maxDistance:1e4,panningModel:typeof n.panningModel<"u"?n.panningModel:"HRTF",refDistance:typeof n.refDistance<"u"?n.refDistance:1,rolloffFactor:typeof n.rolloffFactor<"u"?n.rolloffFactor:1},r._onstereo=n.onstereo?[{fn:n.onstereo}]:[],r._onpos=n.onpos?[{fn:n.onpos}]:[],r._onorientation=n.onorientation?[{fn:n.onorientation}]:[],e.call(this,n)}}(Howl.prototype.init),Howl.prototype.stereo=function(e,n){var r=this;if(!r._webAudio)return r;if(r._state!=="loaded")return r._queue.push({event:"stereo",action:function(){r.stereo(e,n)}}),r;var s=typeof Howler.ctx.createStereoPanner>"u"?"spatial":"stereo";if(typeof n>"u")if(typeof e=="number")r._stereo=e,r._pos=[e,0,0];else return r._stereo;for(var l=r._getSoundIds(n),f=0;f<l.length;f++){var d=r._soundById(l[f]);if(d)if(typeof e=="number")d._stereo=e,d._pos=[e,0,0],d._node&&(d._pannerAttr.panningModel="equalpower",(!d._panner||!d._panner.pan)&&t(d,s),s==="spatial"?typeof d._panner.positionX<"u"?(d._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),d._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),d._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):d._panner.setPosition(e,0,0):d._panner.pan.setValueAtTime(e,Howler.ctx.currentTime)),r._emit("stereo",d._id);else return d._stereo}return r},Howl.prototype.pos=function(e,n,r,s){var l=this;if(!l._webAudio)return l;if(l._state!=="loaded")return l._queue.push({event:"pos",action:function(){l.pos(e,n,r,s)}}),l;if(n=typeof n!="number"?0:n,r=typeof r!="number"?-.5:r,typeof s>"u")if(typeof e=="number")l._pos=[e,n,r];else return l._pos;for(var f=l._getSoundIds(s),d=0;d<f.length;d++){var u=l._soundById(f[d]);if(u)if(typeof e=="number")u._pos=[e,n,r],u._node&&((!u._panner||u._panner.pan)&&t(u,"spatial"),typeof u._panner.positionX<"u"?(u._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),u._panner.positionY.setValueAtTime(n,Howler.ctx.currentTime),u._panner.positionZ.setValueAtTime(r,Howler.ctx.currentTime)):u._panner.setPosition(e,n,r)),l._emit("pos",u._id);else return u._pos}return l},Howl.prototype.orientation=function(e,n,r,s){var l=this;if(!l._webAudio)return l;if(l._state!=="loaded")return l._queue.push({event:"orientation",action:function(){l.orientation(e,n,r,s)}}),l;if(n=typeof n!="number"?l._orientation[1]:n,r=typeof r!="number"?l._orientation[2]:r,typeof s>"u")if(typeof e=="number")l._orientation=[e,n,r];else return l._orientation;for(var f=l._getSoundIds(s),d=0;d<f.length;d++){var u=l._soundById(f[d]);if(u)if(typeof e=="number")u._orientation=[e,n,r],u._node&&(u._panner||(u._pos||(u._pos=l._pos||[0,0,-.5]),t(u,"spatial")),typeof u._panner.orientationX<"u"?(u._panner.orientationX.setValueAtTime(e,Howler.ctx.currentTime),u._panner.orientationY.setValueAtTime(n,Howler.ctx.currentTime),u._panner.orientationZ.setValueAtTime(r,Howler.ctx.currentTime)):u._panner.setOrientation(e,n,r)),l._emit("orientation",u._id);else return u._orientation}return l},Howl.prototype.pannerAttr=function(){var e=this,n=arguments,r,s,l;if(!e._webAudio)return e;if(n.length===0)return e._pannerAttr;if(n.length===1)if(typeof n[0]=="object")r=n[0],typeof s>"u"&&(r.pannerAttr||(r.pannerAttr={coneInnerAngle:r.coneInnerAngle,coneOuterAngle:r.coneOuterAngle,coneOuterGain:r.coneOuterGain,distanceModel:r.distanceModel,maxDistance:r.maxDistance,refDistance:r.refDistance,rolloffFactor:r.rolloffFactor,panningModel:r.panningModel}),e._pannerAttr={coneInnerAngle:typeof r.pannerAttr.coneInnerAngle<"u"?r.pannerAttr.coneInnerAngle:e._coneInnerAngle,coneOuterAngle:typeof r.pannerAttr.coneOuterAngle<"u"?r.pannerAttr.coneOuterAngle:e._coneOuterAngle,coneOuterGain:typeof r.pannerAttr.coneOuterGain<"u"?r.pannerAttr.coneOuterGain:e._coneOuterGain,distanceModel:typeof r.pannerAttr.distanceModel<"u"?r.pannerAttr.distanceModel:e._distanceModel,maxDistance:typeof r.pannerAttr.maxDistance<"u"?r.pannerAttr.maxDistance:e._maxDistance,refDistance:typeof r.pannerAttr.refDistance<"u"?r.pannerAttr.refDistance:e._refDistance,rolloffFactor:typeof r.pannerAttr.rolloffFactor<"u"?r.pannerAttr.rolloffFactor:e._rolloffFactor,panningModel:typeof r.pannerAttr.panningModel<"u"?r.pannerAttr.panningModel:e._panningModel});else return l=e._soundById(parseInt(n[0],10)),l?l._pannerAttr:e._pannerAttr;else n.length===2&&(r=n[0],s=parseInt(n[1],10));for(var f=e._getSoundIds(s),d=0;d<f.length;d++)if(l=e._soundById(f[d]),l){var u=l._pannerAttr;u={coneInnerAngle:typeof r.coneInnerAngle<"u"?r.coneInnerAngle:u.coneInnerAngle,coneOuterAngle:typeof r.coneOuterAngle<"u"?r.coneOuterAngle:u.coneOuterAngle,coneOuterGain:typeof r.coneOuterGain<"u"?r.coneOuterGain:u.coneOuterGain,distanceModel:typeof r.distanceModel<"u"?r.distanceModel:u.distanceModel,maxDistance:typeof r.maxDistance<"u"?r.maxDistance:u.maxDistance,refDistance:typeof r.refDistance<"u"?r.refDistance:u.refDistance,rolloffFactor:typeof r.rolloffFactor<"u"?r.rolloffFactor:u.rolloffFactor,panningModel:typeof r.panningModel<"u"?r.panningModel:u.panningModel};var _=l._panner;_||(l._pos||(l._pos=e._pos||[0,0,-.5]),t(l,"spatial"),_=l._panner),_.coneInnerAngle=u.coneInnerAngle,_.coneOuterAngle=u.coneOuterAngle,_.coneOuterGain=u.coneOuterGain,_.distanceModel=u.distanceModel,_.maxDistance=u.maxDistance,_.refDistance=u.refDistance,_.rolloffFactor=u.rolloffFactor,_.panningModel=u.panningModel}return e},Sound.prototype.init=function(e){return function(){var n=this,r=n._parent;n._orientation=r._orientation,n._stereo=r._stereo,n._pos=r._pos,n._pannerAttr=r._pannerAttr,e.call(this),n._stereo?r.stereo(n._stereo):n._pos&&r.pos(n._pos[0],n._pos[1],n._pos[2],n._id)}}(Sound.prototype.init),Sound.prototype.reset=function(e){return function(){var n=this,r=n._parent;return n._orientation=r._orientation,n._stereo=r._stereo,n._pos=r._pos,n._pannerAttr=r._pannerAttr,n._stereo?r.stereo(n._stereo):n._pos?r.pos(n._pos[0],n._pos[1],n._pos[2],n._id):n._panner&&(n._panner.disconnect(0),n._panner=void 0,r._refreshBuffer(n)),e.call(this)}}(Sound.prototype.reset);var t=function(e,n){n=n||"spatial",n==="spatial"?(e._panner=Howler.ctx.createPanner(),e._panner.coneInnerAngle=e._pannerAttr.coneInnerAngle,e._panner.coneOuterAngle=e._pannerAttr.coneOuterAngle,e._panner.coneOuterGain=e._pannerAttr.coneOuterGain,e._panner.distanceModel=e._pannerAttr.distanceModel,e._panner.maxDistance=e._pannerAttr.maxDistance,e._panner.refDistance=e._pannerAttr.refDistance,e._panner.rolloffFactor=e._pannerAttr.rolloffFactor,e._panner.panningModel=e._pannerAttr.panningModel,typeof e._panner.positionX<"u"?(e._panner.positionX.setValueAtTime(e._pos[0],Howler.ctx.currentTime),e._panner.positionY.setValueAtTime(e._pos[1],Howler.ctx.currentTime),e._panner.positionZ.setValueAtTime(e._pos[2],Howler.ctx.currentTime)):e._panner.setPosition(e._pos[0],e._pos[1],e._pos[2]),typeof e._panner.orientationX<"u"?(e._panner.orientationX.setValueAtTime(e._orientation[0],Howler.ctx.currentTime),e._panner.orientationY.setValueAtTime(e._orientation[1],Howler.ctx.currentTime),e._panner.orientationZ.setValueAtTime(e._orientation[2],Howler.ctx.currentTime)):e._panner.setOrientation(e._orientation[0],e._orientation[1],e._orientation[2])):(e._panner=Howler.ctx.createStereoPanner(),e._panner.pan.setValueAtTime(e._stereo,Howler.ctx.currentTime)),e._panner.connect(e._node),e._paused||e._parent.pause(e._id,!0).play(e._id,!0)}})()}($n)),$n}$i();class Hi{constructor(){this.sounds={},this.soundEnabled=!0,this.volume=.7,this.initializeDummySounds()}initializeDummySounds(){this.audioContext=new(window.AudioContext||window.webkitAudioContext),this.sounds={"coin-pickup":this.createToneSound(800,.1),"coin-drop":this.createToneSound(400,.2),"register-open":this.createToneSound(600,.3),success:this.createSuccessSound(),wrong:this.createErrorSound(),"level-up":this.createLevelUpSound(),"ten-conversion":this.createMagicSound()}}createToneSound(t,e){return{play:()=>{if(!this.soundEnabled)return;const n=this.audioContext.createOscillator(),r=this.audioContext.createGain();n.connect(r),r.connect(this.audioContext.destination),n.frequency.value=t,n.type="sine",r.gain.setValueAtTime(0,this.audioContext.currentTime),r.gain.linearRampToValueAtTime(this.volume*.3,this.audioContext.currentTime+.01),r.gain.exponentialRampToValueAtTime(.01,this.audioContext.currentTime+e),n.start(this.audioContext.currentTime),n.stop(this.audioContext.currentTime+e)}}}createSuccessSound(){return{play:()=>{if(!this.soundEnabled)return;const t=[523,659,784,1047],e=.15;t.forEach((n,r)=>{setTimeout(()=>{const s=this.audioContext.createOscillator(),l=this.audioContext.createGain();s.connect(l),l.connect(this.audioContext.destination),s.frequency.value=n,s.type="triangle",l.gain.setValueAtTime(0,this.audioContext.currentTime),l.gain.linearRampToValueAtTime(this.volume*.2,this.audioContext.currentTime+.01),l.gain.exponentialRampToValueAtTime(.01,this.audioContext.currentTime+e),s.start(this.audioContext.currentTime),s.stop(this.audioContext.currentTime+e)},r*100)})}}}createErrorSound(){return{play:()=>{if(!this.soundEnabled)return;const t=this.audioContext.createOscillator(),e=this.audioContext.createGain();t.connect(e),e.connect(this.audioContext.destination),t.frequency.setValueAtTime(200,this.audioContext.currentTime),t.frequency.linearRampToValueAtTime(100,this.audioContext.currentTime+.3),t.type="sawtooth",e.gain.setValueAtTime(0,this.audioContext.currentTime),e.gain.linearRampToValueAtTime(this.volume*.3,this.audioContext.currentTime+.01),e.gain.exponentialRampToValueAtTime(.01,this.audioContext.currentTime+.3),t.start(this.audioContext.currentTime),t.stop(this.audioContext.currentTime+.3)}}}createLevelUpSound(){return{play:()=>{if(!this.soundEnabled)return;const t=[523,587,659,698,784,880,988,1047],e=.1;t.forEach((n,r)=>{setTimeout(()=>{const s=this.audioContext.createOscillator(),l=this.audioContext.createGain();s.connect(l),l.connect(this.audioContext.destination),s.frequency.value=n,s.type="triangle",l.gain.setValueAtTime(0,this.audioContext.currentTime),l.gain.linearRampToValueAtTime(this.volume*.15,this.audioContext.currentTime+.01),l.gain.exponentialRampToValueAtTime(.01,this.audioContext.currentTime+e),s.start(this.audioContext.currentTime),s.stop(this.audioContext.currentTime+e)},r*50)})}}}createMagicSound(){return{play:()=>{if(this.soundEnabled)for(let t=0;t<5;t++)setTimeout(()=>{const e=this.audioContext.createOscillator(),n=this.audioContext.createGain();e.connect(n),n.connect(this.audioContext.destination);const r=800+Math.random()*800;e.frequency.value=r,e.type="sine",n.gain.setValueAtTime(0,this.audioContext.currentTime),n.gain.linearRampToValueAtTime(this.volume*.2,this.audioContext.currentTime+.01),n.gain.exponentialRampToValueAtTime(.01,this.audioContext.currentTime+.3),e.start(this.audioContext.currentTime),e.stop(this.audioContext.currentTime+.3)},t*100)}}}play(t){if(this.sounds[t]&&this.soundEnabled)try{this.sounds[t].play()}catch(e){console.warn(`Could not play sound: ${t}`,e)}}setVolume(t){this.volume=Math.max(0,Math.min(1,t))}enableSound(){this.soundEnabled=!0}disableSound(){this.soundEnabled=!1}toggleSound(){return this.soundEnabled=!this.soundEnabled,this.soundEnabled}}const Ge=new Hi;/**
 * anime.js - ESM
 * @version v4.0.2
 * @author Julian Garnier
 * @license MIT
 * @copyright (c) 2025 Julian Garnier
 * @see https://animejs.com
 */const Ye=typeof window<"u",Hn=Ye?window:null,Pt=Ye?document:null,U={OBJECT:0,ATTRIBUTE:1,CSS:2,TRANSFORM:3,CSS_VAR:4},O={NUMBER:0,UNIT:1,COLOR:2,COMPLEX:3},Oe={NONE:0,AUTO:1,FORCE:2},be={replace:0,none:1,blend:2},bo=Symbol(),oo=Symbol(),Zo=Symbol(),xn=Symbol(),Gi=Symbol(),L=1e-11,Jo=1e12,jt=1e3,Jn=120,pt="",Qt=new Map;Qt.set("x","translateX");Qt.set("y","translateY");Qt.set("z","translateZ");const io=["translateX","translateY","translateZ","rotate","rotateX","rotateY","rotateZ","scale","scaleX","scaleY","scaleZ","skew","skewX","skewY","perspective","matrix","matrix3d"],Qo=io.reduce((i,t)=>({...i,[t]:t+"("}),{}),je=()=>{},Vi=/(^#([\da-f]{3}){1,2}$)|(^#([\da-f]{4}){1,2}$)/i,Xi=/rgb\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/i,qi=/rgba\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(-?\d+|-?\d*.\d+)\s*\)/i,Ui=/hsl\(\s*(-?\d+|-?\d*.\d+)\s*,\s*(-?\d+|-?\d*.\d+)%\s*,\s*(-?\d+|-?\d*.\d+)%\s*\)/i,Yi=/hsla\(\s*(-?\d+|-?\d*.\d+)\s*,\s*(-?\d+|-?\d*.\d+)%\s*,\s*(-?\d+|-?\d*.\d+)%\s*,\s*(-?\d+|-?\d*.\d+)\s*\)/i,wo=/[-+]?\d*\.?\d+(?:e[-+]?\d)?/gi,Wi=/^([-+]?\d*\.?\d+(?:e[-+]?\d+)?)([a-z]+|%)$/i,Zi=/([a-z])([A-Z])/g,Ji=/(\w+)(\([^)]+\)+)/g,Ko={id:null,keyframes:null,playbackEase:null,playbackRate:1,frameRate:Jn,loop:0,reversed:!1,alternate:!1,autoplay:!0,duration:jt,delay:0,loopDelay:0,ease:"out(2)",composition:be.replace,modifier:i=>i,onBegin:je,onBeforeUpdate:je,onUpdate:je,onLoop:je,onPause:je,onComplete:je,onRender:je},ie={defaults:Ko,root:Pt,precision:4,timeScale:1,tickThreshold:200},zo={version:"4.0.2",engine:null};Ye&&(Hn.AnimeJS||(Hn.AnimeJS=[]),Hn.AnimeJS.push(zo));const Qi=i=>i.replace(Zi,"$1-$2").toLowerCase(),Ct=(i,t)=>i.indexOf(t)===0,Yt=Date.now,Wt=Array.isArray,Gn=i=>i&&i.constructor===Object,Ki=i=>typeof i=="number"&&!isNaN(i),Cn=i=>typeof i=="string",An=i=>typeof i=="function",R=i=>typeof i>"u",Vn=i=>R(i)||i===null,ei=i=>Ye&&i instanceof SVGElement,ti=i=>Vi.test(i),ni=i=>Ct(i,"rgb"),oi=i=>Ct(i,"hsl"),zi=i=>ti(i)||ni(i)||oi(i),hn=i=>!ie.defaults.hasOwnProperty(i),sn=i=>Cn(i)?parseFloat(i):i,wt=Math.pow,er=Math.sqrt,tr=Math.sin,nr=Math.cos,or=Math.abs,ir=Math.ceil,ii=Math.floor,rr=Math.asin,ro=Math.PI,Ao=Math.round,ue=(i,t,e)=>i<t?t:i>e?e:i,Eo={},Q=(i,t)=>{if(t<0)return i;if(!t)return Ao(i);let e=Eo[t];return e||(e=Eo[t]=10**t),Ao(i*e)/e},dt=(i,t,e)=>i+(t-i)*e,so=i=>i===1/0?Jo:i===-1/0?-1e12:i,Ut=i=>i<=L?L:so(Q(i,11)),fe=i=>Wt(i)?[...i]:i,sr=(i,t)=>{const e={...i};for(let n in t){const r=i[n];e[n]=R(r)?t[n]:r}return e},ee=(i,t,e,n="_prev",r="_next")=>{let s=i._head,l=r;for(e&&(s=i._tail,l=n);s;){const f=s[l];t(s),s=f}},$t=(i,t,e="_prev",n="_next")=>{const r=t[e],s=t[n];r?r[n]=s:i._head=s,s?s[e]=r:i._tail=r,t[e]=null,t[n]=null},St=(i,t,e,n="_prev",r="_next")=>{let s=i._tail;for(;s&&e&&e(s,t);)s=s[n];const l=s?s[r]:i._head;s?s[r]=t:i._head=t,l?l[n]=t:i._tail=t,t[n]=s,t[r]=l};class ri{constructor(t=0){this.deltaTime=0,this._currentTime=t,this._elapsedTime=t,this._startTime=t,this._lastTime=t,this._scheduledTime=0,this._frameDuration=Q(jt/Jn,0),this._fps=Jn,this._speed=1,this._hasChildren=!1,this._head=null,this._tail=null}get fps(){return this._fps}set fps(t){const e=this._frameDuration,n=+t,r=n<L?L:n,s=Q(jt/r,0);this._fps=r,this._frameDuration=s,this._scheduledTime+=s-e}get speed(){return this._speed}set speed(t){const e=+t;this._speed=e<L?L:e}requestTick(t){const e=this._scheduledTime,n=this._elapsedTime;if(this._elapsedTime+=t-n,n<e)return Oe.NONE;const r=this._frameDuration,s=n-e;return this._scheduledTime+=s<r?r:s,Oe.AUTO}computeDeltaTime(t){const e=t-this._lastTime;return this.deltaTime=e,this._lastTime=t,e}}const _n=(i,t,e,n,r)=>{const s=i.parent,l=i.duration,f=i.completed,d=i.iterationDuration,u=i.iterationCount,_=i._currentIteration,o=i._loopDelay,a=i._reversed,c=i._alternate,m=i._hasChildren,p=i._delay,g=i._currentTime,h=p+d,v=t-p,T=ue(g,-p,l),S=ue(v,-p,l),D=v-g,M=S>0,$=S>=l,Y=l<=L,E=r===Oe.FORCE;let re=0,V=v,X=0;if(u>1){const Se=~~(S/(d+($?0:o)));i._currentIteration=ue(Se,0,u),$&&i._currentIteration--,re=i._currentIteration%2,V=S%(d+o)||0}const K=a^(c&&re),k=i._ease;let B=$?K?0:l:K?d-V:V;k&&(B=d*k(B/d)||0);const W=(s?s.backwards:v<g)?!K:!!K;if(i._currentTime=v,i._iterationTime=B,i.backwards=W,M&&!i.began?(i.began=!0,!e&&!(s&&(W||!s.began))&&i.onBegin(i)):v<=0&&(i.began=!1),!e&&!m&&M&&i._currentIteration!==_&&i.onLoop(i),E||r===Oe.AUTO&&(t>=p&&t<=h||t<=p&&T>p||t>=h&&T!==l)||B>=h&&T!==l||B<=p&&T>0||t<=T&&T===l&&f||$&&!f&&Y){if(M&&(i.computeDeltaTime(T),e||i.onBeforeUpdate(i)),!m){const Se=E||(W?D*-1:D)>=ie.tickThreshold,q=i._offset+(s?s._offset:0)+p+B;let b=i._head,ne,se,tt,at,xe=0;for(;b;){const he=b._composition,Ce=b._currentTime,we=b._changeDuration,Mt=b._absoluteStartTime+b._changeDuration,Be=b._nextRep,De=b._prevRep,We=he!==be.none;if((Se||(Ce!==we||q<=Mt+(Be?Be._delay:0))&&(Ce!==0||q>=b._absoluteStartTime))&&(!We||!b._isOverridden&&(!b._isOverlapped||q<=Mt)&&(!Be||Be._isOverridden||q<=Be._absoluteStartTime)&&(!De||De._isOverridden||q>=De._absoluteStartTime+De._changeDuration+b._delay))){const Ze=b._currentTime=ue(B-b._startTime,0,we),te=b._ease(Ze/b._updateDuration),_e=b._modifier,Me=b._valueType,de=b._tweenType,ge=de===U.OBJECT,ht=Me===O.NUMBER,Fe=ht&&ge||te===0||te===1?-1:ie.precision;let ve,_t;if(ht)ve=_t=_e(Q(dt(b._fromNumber,b._toNumber,te),Fe));else if(Me===O.UNIT)_t=_e(Q(dt(b._fromNumber,b._toNumber,te),Fe)),ve=`${_t}${b._unit}`;else if(Me===O.COLOR){const z=b._fromNumbers,$e=b._toNumbers,He=Q(ue(_e(dt(z[0],$e[0],te)),0,255),0),Je=Q(ue(_e(dt(z[1],$e[1],te)),0,255),0),Kt=Q(ue(_e(dt(z[2],$e[2],te)),0,255),0),gt=ue(_e(Q(dt(z[3],$e[3],te),Fe)),0,1);if(ve=`rgba(${He},${Je},${Kt},${gt})`,We){const lt=b._numbers;lt[0]=He,lt[1]=Je,lt[2]=Kt,lt[3]=gt}}else if(Me===O.COMPLEX){ve=b._strings[0];for(let z=0,$e=b._toNumbers.length;z<$e;z++){const He=_e(Q(dt(b._fromNumbers[z],b._toNumbers[z],te),Fe)),Je=b._strings[z+1];ve+=`${Je?He+Je:He}`,We&&(b._numbers[z]=He)}}if(We&&(b._number=_t),!n&&he!==be.blend){const z=b.property;ne=b.target,ge?ne[z]=ve:de===U.ATTRIBUTE?ne.setAttribute(z,ve):(se=ne.style,de===U.TRANSFORM?(ne!==tt&&(tt=ne,at=ne[xn]),at[z]=ve,xe=1):de===U.CSS?se[z]=ve:de===U.CSS_VAR&&se.setProperty(z,ve)),M&&(X=1)}else b._value=ve}if(xe&&b._renderTransforms){let Ze=pt;for(let te in at)Ze+=`${Qo[te]}${at[te]}) `;se.transform=Ze,xe=0}b=b._next}!e&&X&&i.onRender(i)}!e&&M&&i.onUpdate(i)}return s&&Y?!e&&(s.began&&!W&&v>=l&&!f||W&&v<=L&&f)&&(i.onComplete(i),i.completed=!W):M&&$?u===1/0?i._startTime+=i.duration:i._currentIteration>=u-1&&(i.paused=!0,!f&&!m&&(i.completed=!0,!e&&!(s&&(W||!s.began))&&(i.onComplete(i),i._resolve(i)))):i.completed=!1,X},At=(i,t,e,n,r)=>{const s=i._currentIteration;if(_n(i,t,e,n,r),i._hasChildren){const l=i,f=l.backwards,d=n?t:l._iterationTime,u=Yt();let _=0,o=!0;if(!n&&l._currentIteration!==s){const a=l.iterationDuration;ee(l,c=>{if(!f)!c.completed&&!c.backwards&&c._currentTime<c.iterationDuration&&_n(c,a,e,1,Oe.FORCE),c.began=!1,c.completed=!1;else{const m=c.duration,p=c._offset+c._delay,g=p+m;!e&&m<=L&&(!p||g===a)&&c.onComplete(c)}}),e||l.onLoop(l)}ee(l,a=>{const c=Q((d-a._offset)*a._speed,12),m=a._fps<l._fps?a.requestTick(u):r;_+=_n(a,c,e,n,m),!a.completed&&o&&(o=!1)},f),!e&&_&&l.onRender(l),o&&l._currentTime>=l.duration&&(l.paused=!0,l.completed||(l.completed=!0,e||(l.onComplete(l),l._resolve(l))))}},Dt={animation:null,update:je},ar=i=>{let t=Dt.animation;return t||(t={duration:L,computeDeltaTime:je,_offset:0,_delay:0,_head:null,_tail:null},Dt.animation=t,Dt.update=()=>{i.forEach(e=>{for(let n in e){const r=e[n],s=r._head;if(s){const l=s._valueType,f=l===O.COMPLEX||l===O.COLOR?fe(s._fromNumbers):null;let d=s._fromNumber,u=r._tail;for(;u&&u!==s;){if(f)for(let _=0,o=u._numbers.length;_<o;_++)f[_]+=u._numbers[_];else d+=u._number;u=u._prevAdd}s._toNumber=d,s._toNumbers=f}}}),_n(t,1,1,0,Oe.FORCE)}),t},si=Ye?requestAnimationFrame:setImmediate,lr=Ye?cancelAnimationFrame:clearImmediate;class cr extends ri{constructor(t){super(t),this.useDefaultMainLoop=!0,this.pauseOnDocumentHidden=!0,this.defaults=Ko,this.paused=!!(Ye&&Pt.hidden),this.reqId=null}update(){const t=this._currentTime=Yt();if(this.requestTick(t)){this.computeDeltaTime(t);const e=this._speed,n=this._fps;let r=this._head;for(;r;){const s=r._next;r.paused?($t(this,r),this._hasChildren=!!this._tail,r._running=!1,r.completed&&!r._cancelled&&r.cancel()):At(r,(t-r._startTime)*r._speed*e,0,0,r._fps<n?r.requestTick(t):Oe.AUTO),r=s}Dt.update()}}wake(){return this.useDefaultMainLoop&&!this.reqId&&!this.paused&&(this.reqId=si(ai)),this}pause(){return this.paused=!0,ur()}resume(){if(this.paused)return this.paused=!1,ee(this,t=>t.resetTime()),this.wake()}get speed(){return this._speed*(ie.timeScale===1?1:jt)}set speed(t){this._speed=t*ie.timeScale,ee(this,e=>e.speed=e._speed)}get timeUnit(){return ie.timeScale===1?"ms":"s"}set timeUnit(t){const n=t==="s",r=n?.001:1;if(ie.timeScale!==r){ie.timeScale=r,ie.tickThreshold=200*r;const s=n?.001:jt;this.defaults.duration*=s,this._speed*=s}}get precision(){return ie.precision}set precision(t){ie.precision=t}}const ce=(()=>{const i=new cr(Yt());return Ye&&(zo.engine=i,Pt.addEventListener("visibilitychange",()=>{i.pauseOnDocumentHidden&&(Pt.hidden?i.pause():i.resume())})),i})(),ai=()=>{ce._head?(ce.reqId=si(ai),ce.update()):ce.reqId=0},ur=()=>(lr(ce.reqId),ce.reqId=0,ce),dr=(i,t,e)=>{const n=i.style.transform;let r;if(n){const s=i[xn];let l;for(;l=Ji.exec(n);){const f=l[1],d=l[2].slice(1,-1);s[f]=d,f===t&&(r=d,e&&(e[t]=d))}}return n&&!R(r)?r:Ct(t,"scale")?"1":Ct(t,"rotate")||Ct(t,"skew")?"0deg":"0px"};function So(i){const t=Cn(i)?ie.root.querySelectorAll(i):i;if(t instanceof NodeList||t instanceof HTMLCollection)return t}function mr(i){if(Vn(i))return[];if(Wt(i)){const e=i.flat(1/0),n=[];for(let r=0,s=e.length;r<s;r++){const l=e[r];if(!Vn(l)){const f=So(l);if(f)for(let d=0,u=f.length;d<u;d++){const _=f[d];if(!Vn(_)){let o=!1;for(let a=0,c=n.length;a<c;a++)if(n[a]===_){o=!0;break}o||n.push(_)}}else{let d=!1;for(let u=0,_=n.length;u<_;u++)if(n[u]===l){d=!0;break}d||n.push(l)}}}return n}if(!Ye)return[i];const t=So(i);return t?Array.from(t):[i]}function fr(i){const t=mr(i),e=t.length;if(e)for(let n=0;n<e;n++){const r=t[n];if(!r[bo]){r[bo]=!0;const s=ei(r);(r.nodeType||s)&&(r[oo]=!0,r[Zo]=s,r[xn]={})}}return t}const pr=["opacity","rotate","overflow","color"],hr=(i,t)=>{if(pr.includes(t))return!1;if(i.getAttribute(t)||t in i){if(t==="scale"){const e=i.parentNode;return e&&e.tagName==="filter"}return!0}},_r=i=>{const t=Xi.exec(i)||qi.exec(i),e=R(t[4])?1:+t[4];return[+t[1],+t[2],+t[3],e]},gr=i=>{const t=i.length,e=t===4||t===5;return[+("0x"+i[1]+i[e?1:2]),+("0x"+i[e?2:3]+i[e?2:4]),+("0x"+i[e?3:5]+i[e?3:6]),t===5||t===9?+(+("0x"+i[e?4:7]+i[e?4:8])/255).toFixed(3):1]},Xn=(i,t,e)=>(e<0&&(e+=1),e>1&&(e-=1),e<1/6?i+(t-i)*6*e:e<1/2?t:e<2/3?i+(t-i)*(2/3-e)*6:i),vr=i=>{const t=Ui.exec(i)||Yi.exec(i),e=+t[1]/360,n=+t[2]/100,r=+t[3]/100,s=R(t[4])?1:+t[4];let l,f,d;if(n===0)l=f=d=r;else{const u=r<.5?r*(1+n):r+n-r*n,_=2*r-u;l=Q(Xn(_,u,e+1/3)*255,0),f=Q(Xn(_,u,e)*255,0),d=Q(Xn(_,u,e-1/3)*255,0)}return[l,f,d,s]},yr=i=>ni(i)?_r(i):ti(i)?gr(i):oi(i)?vr(i):[0,0,0,1],pe=(i,t)=>R(i)?t:i,nt=(i,t,e,n,r)=>{if(An(i)){const s=()=>{const l=i(t,e,n);return isNaN(+l)?l||0:+l};return r&&(r.func=s),s()}else return i},li=(i,t)=>i[oo]?i[Zo]&&hr(i,t)?U.ATTRIBUTE:io.includes(t)||Qt.get(t)?U.TRANSFORM:Ct(t,"--")?U.CSS_VAR:t in i.style?U.CSS:t in i?U.OBJECT:U.ATTRIBUTE:U.OBJECT,xo=(i,t,e)=>{const n=i.style[t];n&&e&&(e[t]=n);const r=n||getComputedStyle(i[Gi]||i).getPropertyValue(t);return r==="auto"?"0":r},Nt=(i,t,e,n)=>{const r=R(e)?li(i,t):e;return r===U.OBJECT?i[t]||0:r===U.ATTRIBUTE?i.getAttribute(t):r===U.TRANSFORM?dr(i,t,n):r===U.CSS_VAR?xo(i,t,n).trimStart():xo(i,t,n)},Co=(i,t,e)=>e==="-"?i-t:e==="+"?i+t:i*t,ao=()=>({t:O.NUMBER,n:0,u:null,o:null,d:null,s:null}),Ve=(i,t)=>{if(t.t=O.NUMBER,t.n=0,t.u=null,t.o=null,t.d=null,t.s=null,!i)return t;const e=+i;if(isNaN(e)){let n=i;n[1]==="="&&(t.o=n[0],n=n.slice(2));const r=n.includes(" ")?!1:Wi.exec(n);if(r)return t.t=O.UNIT,t.n=+r[1],t.u=r[2],t;if(t.o)return t.n=+n,t;if(zi(n))return t.t=O.COLOR,t.d=yr(n),t;{const s=n.match(wo);return t.t=O.COMPLEX,t.d=s?s.map(Number):[],t.s=n.split(wo)||[],t}}else return t.n=e,t},Do=(i,t)=>(t.t=i._valueType,t.n=i._toNumber,t.u=i._unit,t.o=null,t.d=fe(i._toNumbers),t.s=fe(i._strings),t),mt=ao(),En={_rep:new WeakMap,_add:new Map},lo=(i,t,e="_rep")=>{const n=En[e];let r=n.get(i);return r||(r={},n.set(i,r)),r[t]?r[t]:r[t]={_head:null,_tail:null}},Tr=(i,t)=>i._isOverridden||i._absoluteStartTime>t._absoluteStartTime,gn=i=>{i._isOverlapped=1,i._isOverridden=1,i._changeDuration=L,i._currentTime=L},ci=(i,t)=>{const e=i._composition;if(e===be.replace){const n=i._absoluteStartTime;St(t,i,Tr,"_prevRep","_nextRep");const r=i._prevRep;if(r){const s=r.parent,l=r._absoluteStartTime+r._changeDuration;if(i.parent.id!==s.id&&s.iterationCount>1&&l+(s.duration-s.iterationDuration)>n){gn(r);let u=r._prevRep;for(;u&&u.parent.id===s.id;)gn(u),u=u._prevRep}const f=n-i._delay;if(l>f){const u=r._startTime,_=l-(u+r._updateDuration);r._changeDuration=f-_-u,r._currentTime=r._changeDuration,r._isOverlapped=1,r._changeDuration<L&&gn(r)}let d=!0;if(ee(s,u=>{u._isOverlapped||(d=!1)}),d){const u=s.parent;if(u){let _=!0;ee(u,o=>{o!==s&&ee(o,a=>{a._isOverlapped||(_=!1)})}),_&&u.cancel()}else s.cancel()}}}else if(e===be.blend){const n=lo(i.target,i.property,"_add"),r=ar(En._add);let s=n._head;s||(s={...i},s._composition=be.replace,s._updateDuration=L,s._startTime=0,s._numbers=fe(i._fromNumbers),s._number=0,s._next=null,s._prev=null,St(n,s),St(r,s));const l=i._toNumber;if(i._fromNumber=s._fromNumber-l,i._toNumber=0,i._numbers=fe(i._fromNumbers),i._number=0,s._fromNumber=l,i._toNumbers){const f=fe(i._toNumbers);f&&f.forEach((d,u)=>{i._fromNumbers[u]=s._fromNumbers[u]-d,i._toNumbers[u]=0}),s._fromNumbers=f}St(n,i,null,"_prevAdd","_nextAdd")}return i},br=i=>{const t=i._composition;if(t!==be.none){const e=i.target,n=i.property,l=En._rep.get(e)[n];if($t(l,i,"_prevRep","_nextRep"),t===be.blend){const f=En._add,d=f.get(e);if(!d)return;const u=d[n],_=Dt.animation;$t(u,i,"_prevAdd","_nextAdd");const o=u._head;if(o&&o===u._tail){$t(u,o,"_prevAdd","_nextAdd"),$t(_,o);let a=!0;for(let c in d)if(d[c]._head){a=!1;break}a&&f.delete(e)}}}return i},Io=i=>(i.paused=!0,i.began=!1,i.completed=!1,i),Qn=i=>(i._cancelled&&(i._hasChildren?ee(i,Qn):ee(i,t=>{t._composition!==be.none&&ci(t,lo(t.target,t.property))}),i._cancelled=0),i);let wr=0;class Ar extends ri{constructor(t={},e=null,n=0){super(0);const{id:r,delay:s,duration:l,reversed:f,alternate:d,loop:u,loopDelay:_,autoplay:o,frameRate:a,playbackRate:c,onComplete:m,onLoop:p,onPause:g,onBegin:h,onBeforeUpdate:v,onUpdate:T}=t,S=e?0:ce._elapsedTime,D=e?e.defaults:ie.defaults,M=An(s)||R(s)?D.delay:+s,$=An(l)||R(l)?1/0:+l,Y=pe(u,D.loop),E=pe(_,D.loopDelay),re=Y===!0||Y===1/0||Y<0?1/0:Y+1;let V=0;if(e)V=n;else{let X=Yt();ce.paused&&(ce.requestTick(X),X=ce._elapsedTime),V=X-ce._startTime}this.id=R(r)?++wr:r,this.parent=e,this.duration=so(($+E)*re-E)||L,this.backwards=!1,this.paused=!0,this.began=!1,this.completed=!1,this.onBegin=h||D.onBegin,this.onBeforeUpdate=v||D.onBeforeUpdate,this.onUpdate=T||D.onUpdate,this.onLoop=p||D.onLoop,this.onPause=g||D.onPause,this.onComplete=m||D.onComplete,this.iterationDuration=$,this.iterationCount=re,this._autoplay=e?!1:pe(o,D.autoplay),this._offset=V,this._delay=M,this._loopDelay=E,this._iterationTime=0,this._currentIteration=0,this._resolve=je,this._running=!1,this._reversed=+pe(f,D.reversed),this._reverse=this._reversed,this._cancelled=0,this._alternate=pe(d,D.alternate),this._prev=null,this._next=null,this._elapsedTime=S,this._startTime=S,this._lastTime=S,this._fps=pe(a,D.frameRate),this._speed=pe(c,D.playbackRate)}get cancelled(){return!!this._cancelled}set cancelled(t){t?this.cancel():this.reset(1).play()}get currentTime(){return ue(Q(this._currentTime,ie.precision),-this._delay,this.duration)}set currentTime(t){const e=this.paused;this.pause().seek(+t),e||this.resume()}get iterationCurrentTime(){return Q(this._iterationTime,ie.precision)}set iterationCurrentTime(t){this.currentTime=this.iterationDuration*this._currentIteration+t}get progress(){return ue(Q(this._currentTime/this.duration,5),0,1)}set progress(t){this.currentTime=this.duration*t}get iterationProgress(){return ue(Q(this._iterationTime/this.iterationDuration,5),0,1)}set iterationProgress(t){const e=this.iterationDuration;this.currentTime=e*this._currentIteration+e*t}get currentIteration(){return this._currentIteration}set currentIteration(t){this.currentTime=this.iterationDuration*ue(+t,0,this.iterationCount-1)}get reversed(){return!!this._reversed}set reversed(t){t?this.reverse():this.play()}get speed(){return super.speed}set speed(t){super.speed=t,this.resetTime()}reset(t=0){return Qn(this),this._reversed&&!this._reverse&&(this.reversed=!1),this._iterationTime=this.iterationDuration,At(this,0,1,t,Oe.FORCE),Io(this),this._hasChildren&&ee(this,Io),this}init(t=0){this.fps=this._fps,this.speed=this._speed,!t&&this._hasChildren&&At(this,this.duration,1,t,Oe.FORCE),this.reset(t);const e=this._autoplay;return e===!0?this.resume():e&&!R(e.linked)&&e.link(this),this}resetTime(){const t=1/(this._speed*ce._speed);return this._startTime=Yt()-(this._currentTime+this._delay)*t,this}pause(){return this.paused?this:(this.paused=!0,this.onPause(this),this)}resume(){return this.paused?(this.paused=!1,this.duration<=L&&!this._hasChildren?At(this,L,0,0,Oe.FORCE):(this._running||(St(ce,this),ce._hasChildren=!0,this._running=!0),this.resetTime(),this._startTime-=12,ce.wake()),this):this}restart(){return this.reset(0).resume()}seek(t,e=0,n=0){Qn(this),this.completed=!1;const r=this.paused;return this.paused=!0,At(this,t+this._delay,~~e,~~n,Oe.AUTO),r?this:this.resume()}alternate(){const t=this._reversed,e=this.iterationCount,n=this.iterationDuration,r=e===1/0?ii(Jo/n):e;return this._reversed=+(this._alternate&&!(r%2)?t:!t),e===1/0?this.iterationProgress=this._reversed?1-this.iterationProgress:this.iterationProgress:this.seek(n*r-this._currentTime),this.resetTime(),this}play(){return this._reversed&&this.alternate(),this.resume()}reverse(){return this._reversed||this.alternate(),this.resume()}cancel(){return this._hasChildren?ee(this,t=>t.cancel(),!0):ee(this,br),this._cancelled=1,this.pause()}stretch(t){const e=this.duration,n=Ut(t);if(e===n)return this;const r=t/e,s=t<=L;return this.duration=s?L:n,this.iterationDuration=s?L:Ut(this.iterationDuration*r),this._offset*=r,this._delay*=r,this._loopDelay*=r,this}revert(){At(this,0,1,0,Oe.AUTO);const t=this._autoplay;return t&&t.linked&&t.linked===this&&t.revert(),this.cancel()}complete(){return this.seek(this.duration).cancel()}then(t=je){const e=this.then,n=()=>{this.then=null,t(this),this.then=e,this._resolve=je};return new Promise(r=>(this._resolve=()=>r(n()),this.completed&&this._resolve(),this))}}const Ot=i=>i,ui=(i,t,e)=>(((1-3*e+3*t)*i+(3*e-6*t))*i+3*t)*i,Er=(i,t,e)=>{let n=0,r=1,s,l,f=0;do l=n+(r-n)/2,s=ui(l,t,e)-i,s>0?r=l:n=l;while(or(s)>1e-7&&++f<100);return l},Sr=(i=.5,t=0,e=.5,n=1)=>i===t&&e===n?Ot:r=>r===0||r===1?r:ui(Er(r,i,e),t,n),xr=(i=10,t)=>{const e=t?ir:ii;return n=>e(ue(n,0,1)*i)*(1/i)},di=(...i)=>{const t=i.length;if(!t)return Ot;const e=t-1,n=i[0],r=i[e],s=[0],l=[sn(n)];for(let f=1;f<e;f++){const d=i[f],u=Cn(d)?d.trim().split(" "):[d],_=u[0],o=u[1];s.push(R(o)?f/e:sn(o)/100),l.push(sn(_))}return l.push(sn(r)),s.push(1),function(d){for(let u=1,_=s.length;u<_;u++){const o=s[u];if(d<=o){const a=s[u-1],c=l[u-1];return c+(l[u]-c)*(d-a)/(o-a)}}return l[l.length-1]}},Cr=(i=10,t=1)=>{const e=[0],n=i-1;for(let r=1;r<n;r++){const s=e[r-1],l=r/n,f=(r+1)/n,d=l+(f-l)*Math.random(),u=l*(1-t)+d*t;e.push(ue(u,s,1))}return e.push(1),di(...e)},Dr=ro/2,Po=ro*2,Rt=(i=1.68)=>t=>wt(t,+i),jo={[pt]:Rt,Quad:Rt(2),Cubic:Rt(3),Quart:Rt(4),Quint:Rt(5),Sine:i=>1-nr(i*Dr),Circ:i=>1-er(1-i*i),Expo:i=>i?wt(2,10*i-10):0,Bounce:i=>{let t,e=4;for(;i<((t=wt(2,--e))-1)/11;);return 1/wt(4,3-e)-7.5625*wt((t*3-2)/22-i,2)},Back:(i=1.70158)=>t=>(+i+1)*t*t*t-+i*t*t,Elastic:(i=1,t=.3)=>{const e=ue(+i,1,10),n=ue(+t,L,2),r=n/Po*rr(1/e),s=Po/n;return l=>l===0||l===1?l:-e*wt(2,-10*(1-l))*tr((1-l-r)*s)}},Kn={in:i=>t=>i(t),out:i=>t=>1-i(1-t),inOut:i=>t=>t<.5?i(t*2)/2:1-i(t*-2+2)/2,outIn:i=>t=>t<.5?(1-i(1-t*2))/2:(i(t*2-1)+1)/2},Ir=(i,t,e)=>{if(e[i])return e[i];if(i.indexOf("(")<=-1){const r=Kn[i]||i.includes("Back")||i.includes("Elastic")?t[i]():t[i];return r?e[i]=r:Ot}else{const n=i.slice(0,-1).split("("),r=t[n[0]];return r?e[i]=r(...n[1].split(",")):Ot}},Pr=(()=>{const i={linear:di,irregular:Cr,steps:xr,cubicBezier:Sr};for(let t in Kn)for(let e in jo){const n=jo[e],r=Kn[t];i[t+e]=e===pt||e==="Back"||e==="Elastic"?(s,l)=>r(n(s,l)):r(n)}return i})(),jr={linear:Ot},Oo=i=>An(i)?i:Cn(i)?Ir(i,Pr,jr):Ot,Mo={},Or=(i,t,e)=>{if(e===U.TRANSFORM){const n=Qt.get(i);return n||i}else if(e===U.CSS||e===U.ATTRIBUTE&&ei(t)&&i in t.style){const n=Mo[i];if(n)return n;{const r=i&&Qi(i);return Mo[i]=r,r}}else return i},qn={deg:1,rad:180/ro,turn:360},ko={},Mr=(i,t,e,n=!1)=>{const r=t.u,s=t.n;if(t.t===O.UNIT&&r===e)return t;const l=s+r+e,f=ko[l];if(!R(f)&&!n)t.n=f;else{let d;if(r in qn)d=s*qn[r]/qn[e];else{const _=i.cloneNode(),o=i.parentNode,a=o&&o!==Pt?o:Pt.body;a.appendChild(_);const c=_.style;c.width=100+r;const m=_.offsetWidth||100;c.width=100+e;const p=_.offsetWidth||100,g=m/p;a.removeChild(_),d=g*s}t.n=d,ko[l]=d}return t.t,O.UNIT,t.u=e,t},mi=i=>{if(i._hasChildren)ee(i,mi,!0);else{const t=i;t.pause(),ee(t,e=>{const n=e.property,r=e.target;if(r[oo]){const s=r.style,l=t._inlineStyles[n];if(e._tweenType===U.TRANSFORM){const f=r[xn];if(R(l)||l===pt?delete f[n]:f[n]=l,e._renderTransforms)if(!Object.keys(f).length)s.removeProperty("transform");else{let d=pt;for(let u in f)d+=Qo[u]+f[u]+") ";s.transform=d}}else R(l)||l===pt?s.removeProperty(n):s[n]=l;t._tail===e&&t.targets.forEach(f=>{f.getAttribute&&f.getAttribute("style")===pt&&f.removeAttribute("style")})}})}return i},C=ao(),I=ao(),an={func:null},ln=[null],Tt=[null,null],cn={to:null};let kr=0,ot,Xe;const Nr=(i,t)=>{const e={};if(Wt(i)){const n=[].concat(...i.map(r=>Object.keys(r))).filter(hn);for(let r=0,s=n.length;r<s;r++){const l=n[r],f=i.map(d=>{const u={};for(let _ in d){const o=d[_];hn(_)?_===l&&(u.to=o):u[_]=o}return u});e[l]=f}}else{const n=pe(t.duration,ie.defaults.duration);Object.keys(i).map(s=>({o:parseFloat(s)/100,p:i[s]})).sort((s,l)=>s.o-l.o).forEach(s=>{const l=s.o,f=s.p;for(let d in f)if(hn(d)){let u=e[d];u||(u=e[d]=[]);const _=l*n;let o=u.length,a=u[o-1];const c={to:f[d]};let m=0;for(let p=0;p<o;p++)m+=u[p].duration;o===1&&(c.from=a.to),f.ease&&(c.ease=f.ease),c.duration=_-(o?m:0),u.push(c)}return s});for(let s in e){const l=e[s];let f;for(let d=0,u=l.length;d<u;d++){const _=l[d],o=_.ease;_.ease=f||void 0,f=o}l[0].duration||l.shift()}}return e};class Rr extends Ar{constructor(t,e,n,r,s=!1,l=0,f=0){super(e,n,r);const d=fr(t),u=d.length,_=e.keyframes,o=_?sr(Nr(_,e),e):e,{delay:a,duration:c,ease:m,playbackEase:p,modifier:g,composition:h,onRender:v}=o,T=n?n.defaults:ie.defaults,S=pe(p,T.playbackEase),D=S?Oo(S):null,M=!R(m)&&!R(m.ease),$=M?m.ease:pe(m,D?"linear":T.ease),Y=M?m.duration:pe(c,T.duration),E=pe(a,T.delay),re=g||T.modifier,V=R(h)&&u>=jt?be.none:R(h)?T.composition:h,X={},K=this._offset+(n?n._offset:0);let k=NaN,B=NaN,W=0,Se=0;for(let q=0;q<u;q++){const b=d[q],ne=l||q,se=f||u;let tt=NaN,at=NaN;for(let xe in o)if(hn(xe)){const he=li(b,xe),Ce=Or(xe,b,he);let we=o[xe];const Mt=Wt(we);if(s&&!Mt&&(Tt[0]=we,Tt[1]=we,we=Tt),Mt){const _e=we.length,Me=!Gn(we[0]);_e===2&&Me?(cn.to=we,ln[0]=cn,ot=ln):_e>2&&Me?(ot=[],we.forEach((de,ge)=>{ge?ge===1?(Tt[1]=de,ot.push(Tt)):ot.push(de):Tt[0]=de})):ot=we}else ln[0]=we,ot=ln;let Be=null,De=null,We=NaN,Ze=0,te=0;for(let _e=ot.length;te<_e;te++){const Me=ot[te];Gn(Me)?Xe=Me:(cn.to=Me,Xe=cn),an.func=null;const de=nt(Xe.to,b,ne,se,an);let ge;Gn(de)&&!R(de.to)?(Xe=de,ge=de.to):ge=de;const ht=nt(Xe.from,b,ne,se),Fe=Xe.ease,ve=!R(Fe)&&!R(Fe.ease),_t=ve?Fe.ease:Fe||$,z=ve?Fe.duration:nt(pe(Xe.duration,_e>1?nt(Y,b,ne,se)/_e:Y),b,ne,se),$e=nt(pe(Xe.delay,te?0:E),b,ne,se),He=nt(pe(Xe.composition,V),b,ne,se),Je=Ki(He)?He:be[He],Kt=Xe.modifier||re,gt=!R(ht),lt=!R(ge),zt=Wt(ge),fi=zt||gt&&lt,Dn=De?Ze+$e:$e,In=K+Dn;!Se&&(gt||zt)&&(Se=1);let Ie=De;if(Je!==be.none){Be||(Be=lo(b,Ce));let N=Be._head;for(;N&&!N._isOverridden&&N._absoluteStartTime<=In;)if(Ie=N,N=N._nextRep,N&&N._absoluteStartTime>=In)for(;N;)gn(N),N=N._nextRep}if(fi?(Ve(zt?nt(ge[0],b,ne,se):ht,C),Ve(zt?nt(ge[1],b,ne,se,an):ge,I),C.t===O.NUMBER&&(Ie?Ie._valueType===O.UNIT&&(C.t=O.UNIT,C.u=Ie._unit):(Ve(Nt(b,Ce,he,X),mt),mt.t===O.UNIT&&(C.t=O.UNIT,C.u=mt.u)))):(lt?Ve(ge,I):De?Do(De,I):Ve(n&&Ie&&Ie.parent.parent===n?Ie._value:Nt(b,Ce,he,X),I),gt?Ve(ht,C):De?Do(De,C):Ve(n&&Ie&&Ie.parent.parent===n?Ie._value:Nt(b,Ce,he,X),C)),C.o&&(C.n=Co(Ie?Ie._toNumber:Ve(Nt(b,Ce,he,X),mt).n,C.n,C.o)),I.o&&(I.n=Co(C.n,I.n,I.o)),C.t!==I.t){if(C.t===O.COMPLEX||I.t===O.COMPLEX){const N=C.t===O.COMPLEX?C:I,ae=C.t===O.COMPLEX?I:C;ae.t=O.COMPLEX,ae.s=fe(N.s),ae.d=N.d.map(()=>ae.n)}else if(C.t===O.UNIT||I.t===O.UNIT){const N=C.t===O.UNIT?C:I,ae=C.t===O.UNIT?I:C;ae.t=O.UNIT,ae.u=N.u}else if(C.t===O.COLOR||I.t===O.COLOR){const N=C.t===O.COLOR?C:I,ae=C.t===O.COLOR?I:C;ae.t=O.COLOR,ae.s=N.s,ae.d=[0,0,0,1]}}if(C.u!==I.u){let N=I.u?C:I;N=Mr(b,N,I.u?I.u:C.u,!1)}if(I.d&&C.d&&I.d.length!==C.d.length){const N=C.d.length>I.d.length?C:I,ae=N===C?I:C;ae.d=N.d.map((Gr,co)=>R(ae.d[co])?0:ae.d[co]),ae.s=fe(N.s)}const Pn=Q(+z||L,12),en={parent:this,id:kr++,property:Ce,target:b,_value:null,_func:an.func,_ease:Oo(_t),_fromNumbers:fe(C.d),_toNumbers:fe(I.d),_strings:fe(I.s),_fromNumber:C.n,_toNumber:I.n,_numbers:fe(C.d),_number:C.n,_unit:I.u,_modifier:Kt,_currentTime:0,_startTime:Dn,_delay:+$e,_updateDuration:Pn,_changeDuration:Pn,_absoluteStartTime:In,_tweenType:he,_valueType:I.t,_composition:Je,_isOverlapped:0,_isOverridden:0,_renderTransforms:0,_prevRep:null,_nextRep:null,_prevAdd:null,_nextAdd:null,_prev:null,_next:null};Je!==be.none&&ci(en,Be),isNaN(We)&&(We=en._startTime),Ze=Q(Dn+Pn,12),De=en,W++,St(this,en)}(isNaN(B)||We<B)&&(B=We),(isNaN(k)||Ze>k)&&(k=Ze),he===U.TRANSFORM&&(tt=W-te,at=W)}if(!isNaN(tt)){let xe=0;ee(this,he=>{xe>=tt&&xe<at&&(he._renderTransforms=1,he._composition===be.blend&&ee(Dt.animation,Ce=>{Ce.id===he.id&&(Ce._renderTransforms=1)})),xe++})}}u||console.warn("No target found. Make sure the element you're trying to animate is accessible before creating your animation."),B?(ee(this,q=>{q._startTime-q._delay||(q._delay-=B),q._startTime-=B}),k-=B):B=0,k||(k=L,this.iterationCount=0),this.targets=d,this.duration=k===L?L:so((k+this._loopDelay)*this.iterationCount-this._loopDelay)||L,this.onRender=v||T.onRender,this._ease=D,this._delay=B,this.iterationDuration=k,this._inlineStyles=X,!this._autoplay&&Se&&this.onRender(this)}stretch(t){const e=this.duration;if(e===Ut(t))return this;const n=t/e;return ee(this,r=>{r._updateDuration=Ut(r._updateDuration*n),r._changeDuration=Ut(r._changeDuration*n),r._currentTime*=n,r._startTime*=n,r._absoluteStartTime*=n}),super.stretch(t)}refresh(){return ee(this,t=>{const e=Nt(t.target,t.property,t._tweenType);Ve(e,mt),t._fromNumbers=fe(mt.d),t._fromNumber=mt.n,t._func&&(Ve(t._func(),I),t._toNumbers=fe(I.d),t._strings=fe(I.s),t._toNumber=I.n)}),this}revert(){return super.revert(),mi(this)}then(t){return super.then(t)}}const Ne=(i,t)=>new Rr(i,t,null,0,!1).init(),Lr=["x","y","z"];[...Lr,...io.filter(i=>["X","Y","Z"].some(t=>i.endsWith(t)))];Ye&&(R(CSS)||Object.hasOwnProperty.call(CSS,"registerProperty"));class Br{constructor(){this.animationsEnabled=!0,this.currentAnimations=[]}coinMove(t,e,n,r=500){return this.animationsEnabled?new Promise(s=>{const l=Ne({targets:t,translateX:e,translateY:n,duration:r,ease:"out(4)",complete:s});this.currentAnimations.push(l)}):Promise.resolve()}coinBounce(t){return this.animationsEnabled?new Promise(e=>{const n=Ne({targets:t,scale:[1,1.2,1],duration:300,ease:"outElastic(1, .6)",complete:e});this.currentAnimations.push(n)}):Promise.resolve()}correctAnswer(t){return this.animationsEnabled?new Promise(e=>{this.createConfetti();const n=Ne({targets:t,scale:[1,1.1,1],backgroundColor:["#ffffff","#95E1D3","#ffffff"],duration:1e3,ease:"inOut(2)",complete:e});this.currentAnimations.push(n)}):Promise.resolve()}wrongAnswer(t){return this.animationsEnabled?new Promise(e=>{const n=Ne({targets:t,translateX:[-5,5,-5,5,0],backgroundColor:["#ffffff","#F38181","#ffffff"],duration:500,ease:"inOut(2)",complete:e});this.currentAnimations.push(n)}):Promise.resolve()}tenConversion(t){return this.animationsEnabled?new Promise(e=>{const s=anime({targets:t,translateX:0,translateY:0,scale:[1,.5],rotate:360,duration:800,ease:"inOut(2)",complete:()=>{t.forEach(l=>{l.classList.remove("coin-1"),l.classList.add("coin-10"),l.textContent="10",l.dataset.value="10"});for(let l=1;l<t.length;l++)t[l].remove();Ne({targets:t[0],scale:[.5,1.2,1],rotate:[360,0],duration:500,ease:"outElastic(1, .6)",complete:e})}});this.currentAnimations.push(s)}):Promise.resolve()}customerJump(t){return this.animationsEnabled?new Promise(e=>{const n=Ne({targets:t,translateY:[-20,0],duration:400,ease:"out(4)",loop:3,complete:e});this.currentAnimations.push(n)}):Promise.resolve()}levelUp(t){return this.animationsEnabled?new Promise(e=>{const n=Ne({targets:t,scale:[1,1.5,1],rotate:[0,360],duration:1500,ease:"outElastic(1, .6)",complete:e});this.currentAnimations.push(n)}):Promise.resolve()}fadeIn(t,e=500){return this.animationsEnabled?new Promise(n=>{const r=Ne({targets:t,opacity:[0,1],translateY:[20,0],duration:e,ease:"out(2)",complete:n});this.currentAnimations.push(r)}):(t.style.opacity="1",Promise.resolve())}fadeOut(t,e=500){return this.animationsEnabled?new Promise(n=>{const r=Ne({targets:t,opacity:[1,0],translateY:[0,-20],duration:e,ease:"in(2)",complete:n});this.currentAnimations.push(r)}):(t.style.opacity="0",Promise.resolve())}createConfetti(){const t=document.createElement("div");t.className="confetti-container",document.body.appendChild(t);const e=["#FF6B6B","#4ECDC4","#FFE66D","#95E1D3","#F38181"];for(let n=0;n<30;n++){const r=document.createElement("div");r.style.position="absolute",r.style.width="10px",r.style.height="10px",r.style.backgroundColor=e[Math.floor(Math.random()*e.length)],r.style.left=Math.random()*window.innerWidth+"px",r.style.top="-10px",r.style.borderRadius="50%",t.appendChild(r),Ne({targets:r,translateY:window.innerHeight+100,translateX:(Math.random()-.5)*200,rotate:Math.random()*720,duration:Math.random()*2e3+1e3,ease:"in(2)",complete:()=>{r.remove()}})}setTimeout(()=>{t.parentNode&&t.remove()},3e3)}createSparkles(t){const e=document.createElement("div");e.style.position="absolute",e.style.top="0",e.style.left="0",e.style.width="100%",e.style.height="100%",e.style.pointerEvents="none",e.style.zIndex="1000",t.style.position="relative",t.appendChild(e);for(let n=0;n<8;n++){const r=document.createElement("div");r.textContent="✨",r.style.position="absolute",r.style.fontSize="20px",r.style.left=Math.random()*100+"%",r.style.top=Math.random()*100+"%",r.style.opacity="0",e.appendChild(r),Ne({targets:r,opacity:[0,1,0],scale:[.5,1.5,.5],rotate:Math.random()*360,duration:1e3,delay:n*100,ease:"inOut(2)",complete:()=>{r.remove()}})}setTimeout(()=>{e.parentNode&&e.remove()},1500)}stopAllAnimations(){this.currentAnimations.forEach(t=>{t.pause&&t.pause()}),this.currentAnimations=[]}enableAnimations(){this.animationsEnabled=!0}disableAnimations(){this.animationsEnabled=!1}toggleAnimations(){return this.animationsEnabled=!this.animationsEnabled,this.animationsEnabled}}const Qe=new Br;class Fr{constructor(){this.storageKey="coin-park-game-data",this.defaultData={currentLevel:1,currentProblemIndex:0,completedProblems:[],totalCoins:50,achievements:[],statistics:{correctAnswers:0,totalAttempts:0,totalPlayTime:0,averageTime:0,bestStreaks:0,currentStreak:0},settings:{soundEnabled:!0,animationsEnabled:!0,volume:.7},lastPlayDate:null}}loadGameData(){try{const t=localStorage.getItem(this.storageKey);if(t){const e=JSON.parse(t);return{...this.defaultData,...e}}}catch(t){console.warn("Failed to load game data:",t)}return{...this.defaultData}}saveGameData(t){try{const e={...t,lastPlayDate:new Date().toISOString()};return localStorage.setItem(this.storageKey,JSON.stringify(e)),!0}catch(e){return console.error("Failed to save game data:",e),!1}}updateProgress(t,e,n,r){const s=this.loadGameData();return s.statistics.totalAttempts+=n,s.statistics.totalPlayTime+=r,e?(s.statistics.correctAnswers++,s.statistics.currentStreak++,s.statistics.bestStreaks=Math.max(s.statistics.bestStreaks,s.statistics.currentStreak),s.completedProblems.includes(t)||s.completedProblems.push(t),s.totalCoins+=Math.max(1,4-n)):s.statistics.currentStreak=0,s.statistics.correctAnswers>0&&(s.statistics.averageTime=s.statistics.totalPlayTime/s.statistics.correctAnswers),e&&(s.currentProblemIndex=t+1),this.saveGameData(s),s}updateSettings(t){const e=this.loadGameData();return e.settings={...e.settings,...t},this.saveGameData(e),e.settings}addAchievement(t,e,n){const r=this.loadGameData();return r.achievements.find(s=>s.id===t)?!1:(r.achievements.push({id:t,title:e,description:n,unlockedAt:new Date().toISOString()}),this.saveGameData(r),!0)}checkAchievements(t){const e=[];return[{id:"first_correct",title:"はじめのいっぽ",description:"はじめてせいかいしました！",condition:()=>t.statistics.correctAnswers>=1},{id:"five_correct",title:"がんばりや",description:"5もんせいかいしました！",condition:()=>t.statistics.correctAnswers>=5},{id:"perfect_streak",title:"パーフェクト",description:"3もんれんぞくせいかい！",condition:()=>t.statistics.currentStreak>=3},{id:"coin_collector",title:"コインコレクター",description:"100まいコインをあつめました！",condition:()=>t.totalCoins>=100},{id:"speed_master",title:"はやわざマスター",description:"へいきん10びょう以内でせいかい！",condition:()=>t.statistics.averageTime<=1e4}].forEach(r=>{r.condition()&&!t.achievements.find(s=>s.id===r.id)&&this.addAchievement(r.id,r.title,r.description)&&e.push(r)}),e}resetGameData(){try{return localStorage.removeItem(this.storageKey),!0}catch(t){return console.error("Failed to reset game data:",t),!1}}exportGameData(){const e={...this.loadGameData(),exportedAt:new Date().toISOString(),version:"1.0.0"};return JSON.stringify(e,null,2)}importGameData(t){try{const e=JSON.parse(t);if(!e.statistics||!e.settings)throw new Error("Invalid game data format");const n={...this.defaultData,...e};return this.saveGameData(n),!0}catch(e){return console.error("Failed to import game data:",e),!1}}getPlayStats(){const t=this.loadGameData(),e=t.statistics.totalAttempts>0?(t.statistics.correctAnswers/t.statistics.totalAttempts*100).toFixed(1):0;return{totalProblems:t.completedProblems.length,correctAnswers:t.statistics.correctAnswers,totalAttempts:t.statistics.totalAttempts,accuracyRate:e+"%",totalPlayTime:this.formatTime(t.statistics.totalPlayTime),averageTime:this.formatTime(t.statistics.averageTime),bestStreak:t.statistics.bestStreaks,currentStreak:t.statistics.currentStreak,totalCoins:t.totalCoins,achievements:t.achievements.length}}formatTime(t){const e=Math.floor(t/1e3),n=Math.floor(e/60),r=e%60;return n>0?`${n}分${r}秒`:`${r}秒`}}const Re=new Fr;class $r{constructor(){this.calculator=new Fi,this.currentProblem=null,this.registerAmount=0,this.wrongAttempts=0,this.maxAttempts=3,this.problemStartTime=null,this.levels={1:{name:"2桁の繰り上がり計算",description:"10円玉と1円玉で繰り上がりを学ぼう！",coinTypes:["ten","one"],priceRange:[11,18],singleItemRange:[3,9]},2:{name:"3桁の繰り上がり計算",description:"500円・100円・50円・10円・5円・1円玉でリアルなお買い物体験！",coinTypes:["fivehundred","hundred","fifty","ten","five","one"],priceRange:[101,999],singleItemRanges:[[45,156],[89,234],[156,345],[234,456]]},3:{name:"4桁の繰り上がり計算",description:"1000円札と各種コインで本格的な計算をマスター！",coinTypes:["thousand","fivehundred","hundred","fifty","ten","five","one"],priceRange:[1001,9999],singleItemRanges:[[345,1567],[567,2345],[1234,3456],[2345,4567]]}},this.currentLevel=1,this.itemTemplates={1:[{items:[{name:"りんご",emoji:"🍎"},{name:"バナナ",emoji:"🍌"}],shopType:"くだものやさん"},{items:[{name:"みかん",emoji:"🍊"},{name:"ぶどう",emoji:"🍇"}],shopType:"くだものやさん"},{items:[{name:"いちご",emoji:"🍓"},{name:"もも",emoji:"🍑"}],shopType:"くだものやさん"},{items:[{name:"なし",emoji:"🍐"},{name:"キウイ",emoji:"🥝"}],shopType:"くだものやさん"},{items:[{name:"さくらんぼ",emoji:"🍒"},{name:"パイナップル",emoji:"🍍"}],shopType:"くだものやさん"},{items:[{name:"すいか",emoji:"🍉"},{name:"メロン",emoji:"🍈"}],shopType:"くだものやさん"},{items:[{name:"レモン",emoji:"🍋"},{name:"ライム",emoji:"🟢"}],shopType:"くだものやさん"},{items:[{name:"ココナッツ",emoji:"🥥"},{name:"アボカド",emoji:"🥑"}],shopType:"くだものやさん"},{items:[{name:"マンゴー",emoji:"🥭"},{name:"パパイヤ",emoji:"🧡"}],shopType:"くだものやさん"},{items:[{name:"かき",emoji:"🟠"},{name:"いちじく",emoji:"🟣"}],shopType:"くだものやさん"},{items:[{name:"ブルーベリー",emoji:"🫐"},{name:"ラズベリー",emoji:"🍇"}],shopType:"くだものやさん"},{items:[{name:"ざくろ",emoji:"🟣"},{name:"ライチ",emoji:"🤍"}],shopType:"くだものやさん"},{items:[{name:"にんじん",emoji:"🥕"},{name:"たまねぎ",emoji:"🧅"}],shopType:"やおやさん"},{items:[{name:"トマト",emoji:"🍅"},{name:"きゅうり",emoji:"🥒"}],shopType:"やおやさん"},{items:[{name:"レタス",emoji:"🥬"},{name:"だいこん",emoji:"🌿"}],shopType:"やおやさん"},{items:[{name:"キャベツ",emoji:"🥬"},{name:"ブロッコリー",emoji:"🥦"}],shopType:"やおやさん"},{items:[{name:"なす",emoji:"🍆"},{name:"ピーマン",emoji:"🫑"}],shopType:"やおやさん"},{items:[{name:"じゃがいも",emoji:"🥔"},{name:"さつまいも",emoji:"🍠"}],shopType:"やおやさん"},{items:[{name:"とうもろこし",emoji:"🌽"},{name:"かぼちゃ",emoji:"🎃"}],shopType:"やおやさん"},{items:[{name:"ほうれんそう",emoji:"🥬"},{name:"はくさい",emoji:"🥬"}],shopType:"やおやさん"},{items:[{name:"アスパラ",emoji:"🌱"},{name:"たけのこ",emoji:"🎋"}],shopType:"やおやさん"},{items:[{name:"もやし",emoji:"🌱"},{name:"かいわれ",emoji:"🌱"}],shopType:"やおやさん"},{items:[{name:"ごぼう",emoji:"🥕"},{name:"れんこん",emoji:"⚪"}],shopType:"やおやさん"},{items:[{name:"しいたけ",emoji:"🍄"},{name:"しめじ",emoji:"🍄"}],shopType:"やおやさん"},{items:[{name:"さけ",emoji:"🐟"},{name:"まぐろ",emoji:"🐠"}],shopType:"さかなやさん"},{items:[{name:"えび",emoji:"🦐"},{name:"いか",emoji:"🦑"}],shopType:"さかなやさん"},{items:[{name:"たこ",emoji:"🐙"},{name:"かに",emoji:"🦀"}],shopType:"さかなやさん"},{items:[{name:"あじ",emoji:"🐟"},{name:"さば",emoji:"🐟"}],shopType:"さかなやさん"},{items:[{name:"ぶり",emoji:"🐠"},{name:"たい",emoji:"🐠"}],shopType:"さかなやさん"},{items:[{name:"さんま",emoji:"🐟"},{name:"いわし",emoji:"🐟"}],shopType:"さかなやさん"},{items:[{name:"ひらめ",emoji:"🐟"},{name:"かれい",emoji:"🐟"}],shopType:"さかなやさん"},{items:[{name:"うなぎ",emoji:"🦎"},{name:"あなご",emoji:"🦎"}],shopType:"さかなやさん"},{items:[{name:"ほたて",emoji:"🦪"},{name:"あさり",emoji:"🦪"}],shopType:"さかなやさん"},{items:[{name:"チョコ",emoji:"🍫"},{name:"アメ",emoji:"🍬"}],shopType:"おかしやさん"},{items:[{name:"ケーキ",emoji:"🍰"},{name:"クッキー",emoji:"🍪"}],shopType:"おかしやさん"},{items:[{name:"ドーナツ",emoji:"🍩"},{name:"アイス",emoji:"🍦"}],shopType:"おかしやさん"},{items:[{name:"マシュマロ",emoji:"🤍"},{name:"キャラメル",emoji:"🟤"}],shopType:"おかしやさん"},{items:[{name:"ガム",emoji:"🟢"},{name:"グミ",emoji:"🟡"}],shopType:"おかしやさん"},{items:[{name:"チョコパン",emoji:"🍞"},{name:"カステラ",emoji:"🧁"}],shopType:"おかしやさん"},{items:[{name:"プリン",emoji:"🍮"},{name:"ゼリー",emoji:"🟢"}],shopType:"おかしやさん"},{items:[{name:"ポップコーン",emoji:"🍿"},{name:"せんべい",emoji:"🍘"}],shopType:"おかしやさん"},{items:[{name:"まんじゅう",emoji:"🥮"},{name:"だんご",emoji:"🍡"}],shopType:"おかしやさん"},{items:[{name:"ボール",emoji:"⚽"},{name:"つみき",emoji:"🧱"}],shopType:"おもちゃやさん"},{items:[{name:"ぬいぐるみ",emoji:"🧸"},{name:"パズル",emoji:"🧩"}],shopType:"おもちゃやさん"},{items:[{name:"くるま",emoji:"🚗"},{name:"でんしゃ",emoji:"🚆"}],shopType:"おもちゃやさん"},{items:[{name:"ヨーヨー",emoji:"🪀"},{name:"コマ",emoji:"🌀"}],shopType:"おもちゃやさん"},{items:[{name:"シャボンだま",emoji:"🫧"},{name:"ふうせん",emoji:"🎈"}],shopType:"おもちゃやさん"},{items:[{name:"きょうりゅう",emoji:"🦕"},{name:"ロボット",emoji:"🤖"}],shopType:"おもちゃやさん"},{items:[{name:"ひこうき",emoji:"✈️"},{name:"ふね",emoji:"🚢"}],shopType:"おもちゃやさん"},{items:[{name:"にんぎょう",emoji:"👸"},{name:"ままごと",emoji:"🍳"}],shopType:"おもちゃやさん"},{items:[{name:"ゲーム",emoji:"🎮"},{name:"カード",emoji:"🃏"}],shopType:"おもちゃやさん"},{items:[{name:"えんぴつ",emoji:"✏️"},{name:"けしゴム",emoji:"🧽"}],shopType:"ぶんぼうぐやさん"},{items:[{name:"ノート",emoji:"📓"},{name:"ペン",emoji:"🖊️"}],shopType:"ぶんぼうぐやさん"},{items:[{name:"クレヨン",emoji:"🖍️"},{name:"はさみ",emoji:"✂️"}],shopType:"ぶんぼうぐやさん"},{items:[{name:"のり",emoji:"📎"},{name:"テープ",emoji:"📏"}],shopType:"ぶんぼうぐやさん"},{items:[{name:"じょうぎ",emoji:"📐"},{name:"コンパス",emoji:"🧭"}],shopType:"ぶんぼうぐやさん"},{items:[{name:"えのぐ",emoji:"🎨"},{name:"ふで",emoji:"🖌️"}],shopType:"ぶんぼうぐやさん"}],2:[{items:[{name:"Tシャツ",emoji:"👕"},{name:"ズボン",emoji:"👖"}],shopType:"ようふくやさん"},{items:[{name:"セーター",emoji:"🧥"},{name:"スカート",emoji:"👗"}],shopType:"ようふくやさん"},{items:[{name:"ジャケット",emoji:"🧥"},{name:"くつした",emoji:"🧦"}],shopType:"ようふくやさん"},{items:[{name:"パーカー",emoji:"👘"},{name:"ショーツ",emoji:"🩲"}],shopType:"ようふくやさん"},{items:[{name:"ワンピース",emoji:"👗"},{name:"タイツ",emoji:"🦵"}],shopType:"ようふくやさん"},{items:[{name:"コート",emoji:"🧥"},{name:"マフラー",emoji:"🧣"}],shopType:"ようふくやさん"},{items:[{name:"キャップ",emoji:"🧢"},{name:"ベルト",emoji:"👔"}],shopType:"ようふくやさん"},{items:[{name:"くつ",emoji:"👠"},{name:"サンダル",emoji:"👡"}],shopType:"ようふくやさん"},{items:[{name:"スニーカー",emoji:"👟"},{name:"ブーツ",emoji:"🥾"}],shopType:"ようふくやさん"},{items:[{name:"てぶくろ",emoji:"🧤"},{name:"ぼうし",emoji:"👒"}],shopType:"ようふくやさん"},{items:[{name:"じしょ",emoji:"📚"},{name:"えほん",emoji:"📖"}],shopType:"ほんやさん"},{items:[{name:"マンガ",emoji:"📗"},{name:"ざっし",emoji:"📰"}],shopType:"ほんやさん"},{items:[{name:"しょうせつ",emoji:"📘"},{name:"しじんしゅう",emoji:"📙"}],shopType:"ほんやさん"},{items:[{name:"りょうりほん",emoji:"👨‍🍳"},{name:"りょこうガイド",emoji:"🗺️"}],shopType:"ほんやさん"},{items:[{name:"がくしゅうちょう",emoji:"📓"},{name:"ノート",emoji:"📔"}],shopType:"ほんやさん"},{items:[{name:"アルバム",emoji:"📷"},{name:"カレンダー",emoji:"📅"}],shopType:"ほんやさん"},{items:[{name:"ちず",emoji:"🗺️"},{name:"ずかん",emoji:"📊"}],shopType:"ほんやさん"},{items:[{name:"えんぴつけず",emoji:"✏️"},{name:"しおり",emoji:"🔖"}],shopType:"ほんやさん"},{items:[{name:"ロボット",emoji:"🤖"},{name:"ミニカー",emoji:"🚗"}],shopType:"おもちゃやさん"},{items:[{name:"ぬいぐるみ",emoji:"🧸"},{name:"パズル",emoji:"🧩"}],shopType:"おもちゃやさん"},{items:[{name:"ブロック",emoji:"🧱"},{name:"ボール",emoji:"⚽"}],shopType:"おもちゃやさん"},{items:[{name:"でんしゃ",emoji:"🚆"},{name:"ひこうき",emoji:"✈️"}],shopType:"おもちゃやさん"},{items:[{name:"ドール",emoji:"👸"},{name:"ままごとセット",emoji:"🍳"}],shopType:"おもちゃやさん"},{items:[{name:"トランプ",emoji:"🃏"},{name:"ボードゲーム",emoji:"🎲"}],shopType:"おもちゃやさん"},{items:[{name:"けんだま",emoji:"🪀"},{name:"コマ",emoji:"🌀"}],shopType:"おもちゃやさん"},{items:[{name:"バット",emoji:"🏏"},{name:"グローブ",emoji:"🥎"}],shopType:"スポーツよういんてん"},{items:[{name:"ラケット",emoji:"🎾"},{name:"シューズ",emoji:"👟"}],shopType:"スポーツよういんてん"},{items:[{name:"なわとび",emoji:"🪢"},{name:"フラフープ",emoji:"⭕"}],shopType:"スポーツよういんてん"},{items:[{name:"すいちゅうめがね",emoji:"🥽"},{name:"みずぎ",emoji:"👙"}],shopType:"スポーツよういんてん"},{items:[{name:"サッカーボール",emoji:"⚽"},{name:"バスケットボール",emoji:"🏀"}],shopType:"スポーツよういんてん"},{items:[{name:"セーター",emoji:"🧥"},{name:"くつ",emoji:"👠"}],shopType:"デパート"},{items:[{name:"かばん",emoji:"👜"},{name:"ぼうし",emoji:"👒"}],shopType:"デパート"},{items:[{name:"とけい",emoji:"⌚"},{name:"めがね",emoji:"👓"}],shopType:"デパート"},{items:[{name:"ネクタイ",emoji:"👔"},{name:"ベルト",emoji:"⚫"}],shopType:"デパート"},{items:[{name:"アクセサリー",emoji:"💎"},{name:"こうすい",emoji:"🧴"}],shopType:"デパート"},{items:[{name:"ハンカチ",emoji:"🤍"},{name:"スカーフ",emoji:"🧣"}],shopType:"デパート"},{items:[{name:"かさ",emoji:"☂️"},{name:"てぶくろ",emoji:"🧤"}],shopType:"デパート"},{items:[{name:"くつした",emoji:"🧦"},{name:"したぎ",emoji:"🩲"}],shopType:"デパート"},{items:[{name:"でんち",emoji:"🔋"},{name:"ライト",emoji:"🔦"}],shopType:"でんきやさん"},{items:[{name:"ラジオ",emoji:"📻"},{name:"イヤホン",emoji:"🎧"}],shopType:"でんきやさん"},{items:[{name:"カメラ",emoji:"📷"},{name:"USBケーブル",emoji:"🔌"}],shopType:"でんきやさん"},{items:[{name:"けいたいでんわ",emoji:"📱"},{name:"じゅうでんき",emoji:"🔌"}],shopType:"でんきやさん"},{items:[{name:"ゲームき",emoji:"🎮"},{name:"ソフト",emoji:"💿"}],shopType:"でんきやさん"},{items:[{name:"でんしじしょ",emoji:"📱"},{name:"けいさんき",emoji:"🧮"}],shopType:"でんきやさん"},{items:[{name:"デジカメ",emoji:"📷"},{name:"メモリーカード",emoji:"💾"}],shopType:"でんきやさん"}],3:[{items:[{name:"ダイニングテーブル",emoji:"🪑"},{name:"いす",emoji:"🪑"}],shopType:"かぐやさん"},{items:[{name:"ソファー",emoji:"🛋️"},{name:"テーブル",emoji:"🪑"}],shopType:"かぐやさん"},{items:[{name:"ベッド",emoji:"🛏️"},{name:"クローゼット",emoji:"🚪"}],shopType:"かぐやさん"},{items:[{name:"ほんだな",emoji:"📚"},{name:"デスク",emoji:"🖥️"}],shopType:"かぐやさん"},{items:[{name:"れいぞうこ",emoji:"❄️"},{name:"せんたくき",emoji:"🌀"}],shopType:"かぐやさん"},{items:[{name:"エアコン",emoji:"❄️"},{name:"せんぷうき",emoji:"💨"}],shopType:"かぐやさん"},{items:[{name:"テレビだい",emoji:"📺"},{name:"オーディオラック",emoji:"🎵"}],shopType:"かぐやさん"},{items:[{name:"カーテン",emoji:"🪟"},{name:"ブラインド",emoji:"🪟"}],shopType:"かぐやさん"},{items:[{name:"じゅうたん",emoji:"🟫"},{name:"クッション",emoji:"🔴"}],shopType:"かぐやさん"},{items:[{name:"ランプ",emoji:"💡"},{name:"かがみ",emoji:"🪞"}],shopType:"かぐやさん"},{items:[{name:"パソコン",emoji:"💻"},{name:"プリンター",emoji:"🖨️"}],shopType:"でんきやさん"},{items:[{name:"スマートフォン",emoji:"📱"},{name:"じゅうでんき",emoji:"🔌"}],shopType:"でんきやさん"},{items:[{name:"タブレット",emoji:"📲"},{name:"キーボード",emoji:"⌨️"}],shopType:"でんきやさん"},{items:[{name:"テレビ",emoji:"📺"},{name:"レコーダー",emoji:"📹"}],shopType:"でんきやさん"},{items:[{name:"ゲームき",emoji:"🎮"},{name:"コントローラー",emoji:"🕹️"}],shopType:"でんきやさん"},{items:[{name:"カメラ",emoji:"📷"},{name:"レンズ",emoji:"🔍"}],shopType:"でんきやさん"},{items:[{name:"スピーカー",emoji:"🔊"},{name:"マイク",emoji:"🎤"}],shopType:"でんきやさん"},{items:[{name:"ドライヤー",emoji:"💨"},{name:"アイロン",emoji:"🔥"}],shopType:"でんきやさん"},{items:[{name:"そうじき",emoji:"🧹"},{name:"せんたくき",emoji:"🌀"}],shopType:"でんきやさん"},{items:[{name:"でんしレンジ",emoji:"📦"},{name:"トースター",emoji:"🍞"}],shopType:"でんきやさん"},{items:[{name:"けいじどうしゃ",emoji:"🚗"},{name:"オプション",emoji:"⚙️"}],shopType:"くるまやさん"},{items:[{name:"SUV",emoji:"🚙"},{name:"ナビ",emoji:"🗺️"}],shopType:"くるまやさん"},{items:[{name:"でんきじどうしゃ",emoji:"🔋"},{name:"じゅうでんき",emoji:"🔌"}],shopType:"くるまやさん"},{items:[{name:"トラック",emoji:"🚚"},{name:"タイヤ",emoji:"⚫"}],shopType:"くるまやさん"},{items:[{name:"オートバイ",emoji:"🏍️"},{name:"ヘルメット",emoji:"🪖"}],shopType:"くるまやさん"},{items:[{name:"こくないりょこう",emoji:"🗾"},{name:"ホテル",emoji:"🏨"}],shopType:"りょこうだいりてん"},{items:[{name:"かいがいりょこう",emoji:"✈️"},{name:"ほけん",emoji:"🛡️"}],shopType:"りょこうだいりてん"},{items:[{name:"クルーズ",emoji:"🚢"},{name:"ツアー",emoji:"🎫"}],shopType:"りょこうだいりてん"},{items:[{name:"しんかんせん",emoji:"🚄"},{name:"ざせき",emoji:"💺"}],shopType:"りょこうだいりてん"},{items:[{name:"バスツアー",emoji:"🚌"},{name:"おべんとう",emoji:"🍱"}],shopType:"りょこうだいりてん"},{items:[{name:"じてんしゃ",emoji:"🚲"},{name:"ヘルメット",emoji:"🪖"}],shopType:"バイクやさん"},{items:[{name:"バイク",emoji:"🏍️"},{name:"グローブ",emoji:"🧤"}],shopType:"バイクやさん"},{items:[{name:"スクーター",emoji:"🛵"},{name:"プロテクター",emoji:"🦺"}],shopType:"バイクやさん"},{items:[{name:"でんどうじてんしゃ",emoji:"🔋"},{name:"じゅうでんき",emoji:"🔌"}],shopType:"バイクやさん"},{items:[{name:"マウンテンバイク",emoji:"🚵"},{name:"タイヤ",emoji:"⚫"}],shopType:"バイクやさん"},{items:[{name:"ロードバイク",emoji:"🚴"},{name:"メンテナンス",emoji:"🔧"}],shopType:"バイクやさん"},{items:[{name:"パソコン",emoji:"💻"},{name:"マウス",emoji:"🖱️"}],shopType:"パソコンやさん"},{items:[{name:"キーボード",emoji:"⌨️"},{name:"モニター",emoji:"🖥️"}],shopType:"パソコンやさん"},{items:[{name:"プリンター",emoji:"🖨️"},{name:"スピーカー",emoji:"🔊"}],shopType:"パソコンやさん"},{items:[{name:"タブレット",emoji:"📲"},{name:"タッチペン",emoji:"🖊️"}],shopType:"パソコンやさん"},{items:[{name:"ウェブカメラ",emoji:"📹"},{name:"マイク",emoji:"🎤"}],shopType:"パソコンやさん"},{items:[{name:"ハードディスク",emoji:"💾"},{name:"USBメモリ",emoji:"🔌"}],shopType:"パソコンやさん"},{items:[{name:"ルーター",emoji:"📡"},{name:"LANケーブル",emoji:"🔌"}],shopType:"パソコンやさん"},{items:[{name:"ゲーミングPC",emoji:"🎮"},{name:"ゲーミングマウス",emoji:"🖱️"}],shopType:"パソコンやさん"},{items:[{name:"ソフトウェア",emoji:"💿"},{name:"ライセンス",emoji:"🔐"}],shopType:"パソコンやさん"}]},this.totalProblems=10,this.gameData=Re.loadGameData(),this.currentLevel=this.gameData.currentLevel||1,this.currentProblemIndex=this.gameData.currentProblemIndex,this.problems=this.generateRandomProblems()}start(){this.initElements(),this.setupDragAndDrop(),this.setupEventListeners(),this.loadSettings(),this.updateUI(),this.loadProblem()}initElements(){this.walletElement=document.getElementById("wallet"),this.registerElement=document.getElementById("register-coins"),this.registerAmountElement=document.getElementById("register-amount"),this.checkAnswerBtn=document.getElementById("check-answer"),this.feedbackElement=document.getElementById("feedback"),this.feedbackMessageElement=document.getElementById("feedback-message"),this.nextProblemBtn=document.getElementById("next-problem"),this.customerMessageElement=document.getElementById("customer-message"),this.totalAmountElement=document.getElementById("total-amount"),this.totalHintElement=document.getElementById("total-hint"),this.hintButtonElement=document.getElementById("hint-button"),this.shopTitleElement=document.querySelector(".shop-title"),this.shopItemsElement=document.getElementById("shop-items"),this.totalCoinsElement=document.getElementById("total-coins"),this.currentProblemElement=document.getElementById("progress-current"),this.totalProblemsElement=document.getElementById("progress-total"),this.currentLevelElement=document.getElementById("current-level"),this.progressFillElement=document.getElementById("progress-fill")}setupDragAndDrop(){this.coinSortables&&this.coinSortables.forEach(e=>e.destroy()),this.coinSortables=[],this.levels[this.currentLevel].coinTypes.forEach(e=>{const n=`${e==="ten"?"ten":e==="one"?"one":e}-coins`,r=document.getElementById(n);if(r){const s=new w(r,{group:{name:"coins",pull:!0,put:!0},animation:150,ghostClass:"coin-ghost",onStart:l=>{Ge.play("coin-pickup"),Qe.coinBounce(l.item)},onAdd:()=>{this.updateRegisterAmount()}});this.coinSortables.push(s)}}),this.registerSortable&&this.registerSortable.destroy(),this.registerSortable=new w(this.registerElement,{group:{name:"coins",pull:!0,put:!0},animation:150,onAdd:e=>{Ge.play("coin-drop"),this.updateRegisterAmount(),Qe.coinBounce(e.item)},onRemove:()=>{this.updateRegisterAmount()}})}setupEventListeners(){this.checkAnswerBtn.addEventListener("click",()=>{this.checkAnswer()}),this.nextProblemBtn.addEventListener("click",()=>{this.nextProblem()}),this.hintButtonElement.addEventListener("click",()=>{this.showHint()}),document.getElementById("settings-btn").addEventListener("click",()=>{this.showSettings()}),document.getElementById("help-btn").addEventListener("click",()=>{this.showHelp()})}generateRandomProblems(){return[...this.itemTemplates[this.currentLevel]||this.itemTemplates[1]].sort(()=>Math.random()-.5).slice(0,this.totalProblems).map(r=>{const s=JSON.parse(JSON.stringify(r));return s.items=s.items.map(l=>(l.price=this.generateDynamicPrice(this.currentLevel),l)),this.ensureCarryOverInProblem(s)})}generateDynamicPrice(t){const e=this.levels[t];if(t===1){const[n,r]=e.singleItemRange;return Math.floor(Math.random()*(r-n+1))+n}else{const n=e.singleItemRanges,r=n[Math.floor(Math.random()*n.length)];return Math.floor(Math.random()*(r[1]-r[0]+1))+r[0]}}ensureCarryOverInProblem(t){const e=t.items[0].price,n=t.items[1].price;if(this.currentLevel===1){const r=e%10+n%10;if(r<10){const s=10-r+Math.floor(Math.random()*3);Math.random()<.5?t.items[0].price+=s:t.items[1].price+=s}}else if(!this.calculator.checkCarryOverPattern(e,n)){const s=Math.floor(Math.random()*5)+1;t.items[Math.floor(Math.random()*2)].price+=s}return t}loadProblem(){if(this.currentProblemIndex>=this.totalProblems){this.showGameComplete();return}this.currentProblem=this.problems[this.currentProblemIndex],this.wrongAttempts=0,this.registerAmount=0,this.problemStartTime=Date.now(),this.registerElement.innerHTML="",this.updateRegisterAmount(),this.updateShopDisplay(),this.updateCustomerMessage();const t=this.currentProblem.items.reduce((e,n)=>e+n.price,0);this.totalAmountElement.textContent=t,this.totalHintElement.style.display="none",this.hintButtonElement.style.display="block",this.initializeCoins(t),this.setupDragAndDrop(),this.updateUI()}updateShopDisplay(){this.shopTitleElement.textContent=this.currentProblem.shopType,this.shopItemsElement.innerHTML="",this.currentProblem.items.forEach(t=>{const e=document.createElement("div");e.className="shop-item",e.innerHTML=`
        <div class="item-image">${t.emoji}</div>
        <div class="item-name">${t.name}</div>
        <div class="item-price">${t.price}円</div>
      `,this.shopItemsElement.appendChild(e)})}updateCustomerMessage(){const t=this.currentProblem.items.map(e=>e.name).join("と");this.customerMessageElement.textContent=`${t}ください`}initializeCoins(t){const n=this.levels[this.currentLevel].coinTypes,r={thousand:1e3,fivehundred:500,hundred:100,fifty:50,ten:10,five:5,one:1};this.currentLevel===1?(document.getElementById("ten-coins").innerHTML="",document.getElementById("one-coins").innerHTML=""):document.getElementById("wallet").innerHTML="",n.forEach(s=>{const l=r[s],f=this.calculateCoinCount(s,t);if(this.currentLevel===1){const d=`${s}-coins`,u=document.getElementById(d);if(u)for(let _=0;_<f;_++)u.appendChild(this.createCoin(l))}else this.createCoinGroup(s,l,f)})}calculateCoinCount(t,e){switch(t){case"thousand":return Math.min(3,Math.max(1,Math.ceil(e/1e3)+1));case"fivehundred":return Math.min(4,Math.max(1,Math.ceil(e/500)+1));case"hundred":return Math.min(15,Math.max(2,Math.ceil(e/100)+3));case"fifty":return Math.min(8,Math.max(2,Math.ceil(e/50)+2));case"ten":return Math.min(20,Math.max(3,Math.ceil(e/10)+5));case"five":return Math.min(6,Math.max(2,Math.ceil(e/5)+2));case"one":return Math.min(15,Math.max(5,e%5+8));default:return 0}}createCoinGroup(t,e,n){const r=document.getElementById("wallet"),s=document.createElement("div");s.className="coin-group";const l=document.createElement("div");l.className="coin-label",l.textContent=t==="thousand"?"1000円:":t==="fivehundred"?"500円:":t==="hundred"?"100円:":t==="fifty"?"50円:":t==="ten"?"10円:":t==="five"?"5円:":"1円:";const f=document.createElement("div");f.className="coins-container",f.id=`${t}-coins`;for(let u=0;u<n;u++){const _=this.createCoin(e);f.appendChild(_)}s.appendChild(l),s.appendChild(f),r.appendChild(s);const d=new w(f,{group:{name:"coins",pull:!0,put:!0},animation:150,ghostClass:"coin-ghost",onStart:u=>{Ge.play("coin-pickup"),Qe.coinBounce(u.item)},onAdd:()=>{this.updateRegisterAmount()}});this.coinSortables||(this.coinSortables=[]),this.coinSortables.push(d)}ensureCoinContainer(t){const e=`${t}-coins`;if(!document.getElementById(e)){const n=document.getElementById("wallet"),r=document.createElement("div");r.id=e,r.className="coin-container";const s=document.createElement("h4");s.textContent=t==="thousand"?"1000円札":t==="hundred"?"100円玉":t==="ten"?"10円玉":"1円玉",r.appendChild(s);const l={thousand:0,hundred:1,ten:2,one:3},f=l[t],d=n.querySelectorAll(".coin-container");let u=null;for(const o of d){const a=o.id.replace("-coins","");if(l[a]>f){u=o;break}}u?n.insertBefore(r,u):n.appendChild(r);const _=new w(r,{group:{name:"coins",pull:!0,put:!0},animation:150,ghostClass:"coin-ghost",onStart:o=>{Ge.play("coin-pickup"),Qe.coinBounce(o.item)},onAdd:()=>{this.updateRegisterAmount()}});this.coinSortables||(this.coinSortables=[]),this.coinSortables.push(_)}}createCoin(t){const e=document.createElement("div");return e.className=`coin coin-${t}`,e.draggable=!0,e.dataset.value=t,t===1e3?(e.textContent="1000",e.className+=" coin-bill"):t===500?e.textContent="500":t===50?e.textContent="50":t===5?e.textContent="5":e.textContent=t.toString(),e}updateRegisterAmount(){const t=this.registerElement.querySelectorAll(".coin");this.registerAmount=Array.from(t).reduce((e,n)=>e+parseInt(n.dataset.value),0),this.registerAmountElement.textContent=`${this.registerAmount}円`}checkAnswer(){const t=this.currentProblem.items.reduce((e,n)=>e+n.price,0);this.registerAmount===t?this.showCorrectFeedback():(this.wrongAttempts++,this.wrongAttempts>=this.maxAttempts?this.showCorrectAnswerWithExplanation(t):this.showIncorrectFeedback())}showCorrectFeedback(){Ge.play("success"),Qe.correctAnswer(this.registerElement);const t=Date.now()-this.problemStartTime,e=this.wrongAttempts+1;this.gameData=Re.updateProgress(this.currentProblemIndex,!0,e,t);const n=Re.checkAchievements(this.gameData);let r="";n.length>0&&(r='<div class="achievement-notification">',n.forEach(d=>{r+=`<p>🏆 ${d.title}: ${d.description}</p>`}),r+="</div>");const s=Math.max(1,4-e);this.currentProblemIndex>=this.totalProblems-1?(this.feedbackMessageElement.innerHTML=`
        <div class="success-feedback">
          <h2>🎉 せいかい！</h2>
          <p>よくできました！</p>
          <p>💰 ${s}まいコインをゲット！</p>
          ${r}
        </div>
      `,this.showFeedback(),setTimeout(()=>{this.showGameComplete()},2e3)):(this.feedbackMessageElement.innerHTML=`
        <div class="success-feedback">
          <h2>🎉 せいかい！</h2>
          <p>よくできました！</p>
          <p>💰 ${s}まいコインをゲット！</p>
          ${r}
        </div>
      `,this.showFeedback()),this.updateUI();const f=document.querySelector(".customer");Qe.customerJump(f),Qe.createSparkles(f)}showIncorrectFeedback(){Ge.play("wrong"),Qe.wrongAnswer(this.registerElement);const t=this.maxAttempts-this.wrongAttempts;let e=`
      <div class="error-feedback">
        <h2>❌ ちがいます</h2>
        <p>もう一度かんがえてみましょう</p>
    `;t===1&&(e+="<p>あと1回だけチャンスがあります</p>"),e+="</div>",this.feedbackMessageElement.innerHTML=e,this.showFeedbackWithChoiceButtons()}showCorrectAnswerWithExplanation(t){Ge.play("wrong");const e=this.calculator.visualizeCarryOver(this.currentProblem.items[0].price,this.currentProblem.items[1].price);let n='<div class="calculation-steps">';e.forEach(r=>{n+=`<div class="calculation-step">${r.message||r.action}</div>`}),n+="</div>",this.feedbackMessageElement.innerHTML=`
      <div class="error-feedback">
        <h2>📚 せいかいは ${t}円 です</h2>
        <p>けいさんのしかた：</p>
        ${n}
      </div>
    `,this.showFeedbackWithChoiceButtons()}showFeedback(){this.feedbackElement.style.display="flex",this.feedbackElement.style.opacity="1"}showFeedbackWithChoiceButtons(){this.feedbackElement.style.display="flex",this.feedbackElement.style.opacity="1",this.nextProblemBtn.style.display="none";const t=this.feedbackElement.querySelector(".choice-buttons");t&&t.remove();const e=document.createElement("div");e.className="choice-buttons",this.currentProblemIndex>=this.totalProblems-1?e.innerHTML=`
        <button id="try-again-btn" class="btn btn-primary">もういちど</button>
      `:e.innerHTML=`
        <button id="try-again-btn" class="btn btn-secondary">もういちど</button>
        <button id="skip-problem-btn" class="btn btn-primary">つぎのもんだい</button>
      `,this.feedbackElement.querySelector(".feedback-content").appendChild(e),document.getElementById("try-again-btn").addEventListener("click",()=>{this.tryAgain()});const r=document.getElementById("skip-problem-btn");r&&r.addEventListener("click",()=>{this.nextProblem()})}tryAgain(){this.hideFeedback(),this.registerElement.querySelectorAll(".coin").forEach(e=>{const n=parseInt(e.dataset.value);let r;n===1e3?r=document.getElementById("thousand-coins"):n===500?r=document.getElementById("fivehundred-coins"):n===100?r=document.getElementById("hundred-coins"):n===50?r=document.getElementById("fifty-coins"):n===10?r=document.getElementById("ten-coins"):n===5?r=document.getElementById("five-coins"):n===1&&(r=document.getElementById("one-coins")),r&&r.appendChild(e)}),this.updateRegisterAmount()}hideFeedback(){this.feedbackElement.style.display!=="none"&&(this.feedbackElement.style.opacity="0",setTimeout(()=>{this.feedbackElement.style.display="none",this.feedbackElement.style.opacity="1";const t=this.feedbackElement.querySelector(".choice-buttons");t&&t.remove(),this.nextProblemBtn.style.display="block"},300))}nextProblem(){this.hideFeedback(),this.currentProblemIndex++,this.wrongAttempts=0,setTimeout(()=>{console.log(`Loading problem ${this.currentProblemIndex+1}/${this.totalProblems}`),this.loadProblem()},100)}showGameComplete(){this.currentProblemIndex=0,this.gameData.currentProblemIndex=0,Re.saveGameData(this.gameData);const t=Re.getPlayStats();this.feedbackMessageElement.innerHTML=`
      <div class="success-feedback">
        <h2>🏆 ゲームクリア！</h2>
        <p>10もんだいすべてクリアしました！</p>
        <p>せいかいりつ: ${t.accuracyRate}</p>
        <p>おつかれさまでした！</p>
      </div>
    `,this.showFeedback(),this.nextProblemBtn.textContent="もう一度あそぶ";const e=this.nextProblemBtn.cloneNode(!0);this.nextProblemBtn.parentNode.replaceChild(e,this.nextProblemBtn),this.nextProblemBtn=e,this.nextProblemBtn.addEventListener("click",()=>{this.currentProblemIndex=0,this.gameData.currentProblemIndex=0,Re.saveGameData(this.gameData),this.problems=this.generateRandomProblems(),this.hideFeedback(),setTimeout(()=>{console.log("Restarting game with new problems"),this.loadProblem(),this.nextProblemBtn.textContent="つぎのもんだい"},100)})}loadSettings(){Ge.enableSound=this.gameData.settings.soundEnabled,Ge.setVolume(this.gameData.settings.volume),Qe.animationsEnabled=this.gameData.settings.animationsEnabled}updateUI(){this.totalCoinsElement.textContent=this.gameData.totalCoins,this.currentProblemElement.textContent=this.currentProblemIndex+1,this.totalProblemsElement.textContent=this.totalProblems,this.currentLevelElement.textContent=this.currentLevel,this.updateProgress()}updateProgress(){const e=(this.currentProblemIndex+1)/this.totalProblems*100;this.progressFillElement&&(this.progressFillElement.style.width=`${e}%`)}changeLevel(t){this.currentLevel=t,this.gameData.currentLevel=t,this.gameData.currentProblemIndex=0,Re.saveGameData(this.gameData),this.resetWallet(),this.resetCurrentGame(),console.log(`Level changed to ${t}`)}resetWallet(){this.coinSortables&&this.coinSortables.forEach(e=>e.destroy()),this.coinSortables=[];const t=document.getElementById("wallet");this.currentLevel===1?t.innerHTML=`
        <div class="coin-group">
          <div class="coin-label">10円:</div>
          <div class="coins-container" id="ten-coins">
            <!-- コインは動的に生成されます -->
          </div>
        </div>
        <div class="coin-group">
          <div class="coin-label">1円:</div>
          <div class="coins-container" id="one-coins">
            <!-- コインは動的に生成されます -->
          </div>
        </div>
      `:t.innerHTML=""}resetCurrentGame(){this.currentProblemIndex=0,this.problems=this.generateRandomProblems(),this.wrongAttempts=0,this.registerAmount=0,this.registerElement.innerHTML="",this.updateRegisterAmount(),this.feedbackElement.style.display="none",this.loadProblem(),console.log("Game reset to first problem")}showHint(){Ge.play("ten-conversion"),this.totalHintElement.style.display="block",this.hintButtonElement.style.display="none",this.totalHintElement.classList.add("fade-in"),setTimeout(()=>{this.totalHintElement.classList.remove("fade-in")},500)}showSettings(){const t=Re.getPlayStats(),e=`
      <div class="modal-content">
        <div class="modal-header">
          <h3>設定</h3>
          <button class="modal-close" onclick="this.closest('.modal-overlay').remove()">×</button>
        </div>
        <div class="modal-body">
          <div class="setting-item">
            <label>
              <input type="checkbox" id="sound-toggle" ${this.gameData.settings.soundEnabled?"checked":""}>
              音声をONにする
            </label>
          </div>
          <div class="setting-item">
            <label>
              <input type="checkbox" id="animation-toggle" ${this.gameData.settings.animationsEnabled?"checked":""}>
              アニメーションをONにする
            </label>
          </div>
          
          <h4>レベルせんたく</h4>
          <div class="level-selection">
            ${Object.entries(this.levels).map(([r,s])=>`
              <div class="level-option">
                <label>
                  <input type="radio" name="level" value="${r}" ${this.currentLevel==r?"checked":""}>
                  <span class="level-info">
                    <strong>レベル${r}: ${s.name}</strong>
                    <br><small>${s.description}</small>
                  </span>
                </label>
              </div>
            `).join("")}
          </div>
          
          <h4>ゲームとうけい</h4>
          <div class="stats">
            <p>せいかいすう: ${t.correctAnswers}</p>
            <p>せいかいりつ: ${t.accuracyRate}</p>
            <p>さいこうれんぞく: ${t.bestStreak}</p>
            <p>コインすう: ${t.totalCoins}</p>
            <p>じっせき: ${t.achievements}こ</p>
          </div>
          
          <div class="setting-buttons">
            <button onclick="this.closest('.modal-overlay').remove()">とじる</button>
            <button id="reset-game-btn">ゲームをさいしょから</button>
            <button id="reset-data-btn">データリセット</button>
          </div>
        </div>
      </div>
    `,n=document.createElement("div");n.className="modal-overlay",n.innerHTML=e,document.body.appendChild(n),n.querySelector("#sound-toggle").addEventListener("change",r=>{this.gameData.settings.soundEnabled=r.target.checked,Re.updateSettings(this.gameData.settings),this.loadSettings()}),n.querySelector("#animation-toggle").addEventListener("change",r=>{this.gameData.settings.animationsEnabled=r.target.checked,Re.updateSettings(this.gameData.settings),this.loadSettings()}),n.querySelectorAll('input[name="level"]').forEach(r=>{r.addEventListener("change",s=>{const l=parseInt(s.target.value);l!==this.currentLevel&&(confirm(`レベル${l}に変更しますか？
現在のゲーム進行はリセットされます。`)?(this.changeLevel(l),n.remove()):n.querySelector(`input[value="${this.currentLevel}"]`).checked=!0)})}),n.querySelector("#reset-game-btn").addEventListener("click",()=>{confirm("げんざいのゲームをリセットして、さいしょからはじめますか？")&&(this.resetCurrentGame(),n.remove())}),n.querySelector("#reset-data-btn").addEventListener("click",()=>{confirm(`すべてのデータ（とうけい、じっせき、コイン）をリセットしますか？
このそうさはもとにもどせません。`)&&(Re.resetGameData(),location.reload())}),n.addEventListener("click",r=>{r.target===n&&n.remove()})}showHelp(){const t=`
      <div class="modal-content">
        <div class="modal-header">
          <h3>あそびかた</h3>
          <button class="modal-close" onclick="this.closest('.modal-overlay').remove()">×</button>
        </div>
        <div class="modal-body">
          <div class="help-content">
            <p>1. おきゃくさんがほしいものをいいます</p>
            <p>2. おねだんをけいさんします</p>
            <p>3. おさいふからコインをレジにうつします</p>
            <p>4. 「おしはらい」ボタンをおします</p>
            
            <h4>コインについて</h4>
            <p>🪙 10円玉：きんいろのコイン</p>
            <p>🪙 1円玉：ぎんいろのコイン</p>
            
            <h4>けいさんのコツ</h4>
            <p>10になるくみあわせをさがしてみよう！</p>
            <p>たとえば 7 + 5 = 12 のときは</p>
            <p>7 + 3 = 10、あと 2 をたして 12！</p>
            
            <div class="setting-buttons">
              <button onclick="this.closest('.modal-overlay').remove()">とじる</button>
            </div>
          </div>
        </div>
      </div>
    `,e=document.createElement("div");e.className="modal-overlay",e.innerHTML=t,document.body.appendChild(e),e.addEventListener("click",n=>{n.target===e&&e.remove()})}}class Hr{constructor(){this.gameEngine=new $r,this.init()}init(){document.addEventListener("DOMContentLoaded",()=>{this.gameEngine.start()})}}new Hr;
